!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.mywaveAiJsSdk=t():e.mywaveAiJsSdk=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=102)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var r=n(37),i=n(38);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){var r=n(15);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(83);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var r=n(39),i=n(42),o=n(55),u=n(57),s=n(58),a=n(59),c=n(19),l=n(61),f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(u(e)||"string"==typeof e||"function"==typeof e.splice||a(e)||l(e)||o(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!r(e).length;for(var n in e)if(f.call(e,n))return!1;return!0}},function(e,t,n){"use strict";var r=n(29),i=n(85),o=Object.prototype.toString;function u(e){return"[object Array]"===o.call(e)}function s(e){return null!==e&&"object"==typeof e}function a(e){return"[object Function]"===o.call(e)}function c(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),u(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:u,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:i,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:s,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:a,isStream:function(e){return s(e)&&a(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:c,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)c(arguments[r],n);return t},extend:function(e,t,n){return c(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){var r=n(68),i=n(27),o=/[T ]/,u=/:/,s=/^(\d{2})$/,a=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],c=/^(\d{4})/,l=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],f=/^-(\d{2})$/,h=/^-?(\d{3})$/,d=/^-?(\d{2})-?(\d{2})$/,v=/^-?W(\d{2})$/,y=/^-?W(\d{2})-?(\d{1})$/,_=/^(\d{2}([.,]\d*)?)$/,p=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,m=/([Z+-].*)$/,k=/^(Z)$/,S=/^([+-])(\d{2})$/,O=/^([+-])(\d{2}):?(\d{2})$/;function b(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,t){if(i(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?2:Number(n);var E=function(e){var t,n={},r=e.split(o);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var i=m.exec(t);i?(n.time=t.replace(i[1],""),n.timezone=i[1]):n.time=t}return n}(e),C=function(e,t){var n,r=a[t],i=l[t];if(n=c.exec(e)||i.exec(e)){var o=n[1];return{year:parseInt(o,10),restDateString:e.slice(o.length)}}if(n=s.exec(e)||r.exec(e)){var u=n[1];return{year:100*parseInt(u,10),restDateString:e.slice(u.length)}}return{year:null}}(E.date,n),T=C.year,w=function(e,t){if(null===t)return null;var n,r,i,o;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=f.exec(e))return r=new Date(0),i=parseInt(n[1],10)-1,r.setUTCFullYear(t,i),r;if(n=h.exec(e)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(t,0,u),r}if(n=d.exec(e)){r=new Date(0),i=parseInt(n[1],10)-1;var s=parseInt(n[2],10);return r.setUTCFullYear(t,i,s),r}if(n=v.exec(e))return o=parseInt(n[1],10)-1,b(t,o);if(n=y.exec(e)){o=parseInt(n[1],10)-1;var a=parseInt(n[2],10)-1;return b(t,o,a)}return null}(C.restDateString,T);if(w){var I,A=w.getTime(),j=0;if(E.time&&(j=function(e){var t,n,r;if(t=_.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*36e5;if(t=p.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*36e5+6e4*r;if(t=g.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var i=parseFloat(t[3].replace(",","."));return n%24*36e5+6e4*r+1e3*i}return null}(E.time)),E.timezone)I=6e4*function(e){var t,n;if(t=k.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=O.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(E.timezone);else{var R=A+j,U=new Date(R);I=r(U);var D=new Date(R);D.setDate(U.getDate()+1);var P=r(D)-r(U);P>0&&(I+=P)}return new Date(A+j+I)}return new Date(e)}},function(e,t,n){var r=n(22),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t,n){var r=n(80),i=n(81),o=n(82);e.exports=function(e){return r(e)||i(e)||o()}},function(e,t,n){var r=n(44),i=n(50);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(21),i=n(46),o=n(47),u=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?i(e):o(e)}},function(e,t,n){e.exports=n(84)},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){var r=n(73);e.exports=function(e){return r(e,{weekStartsOn:1})}},function(e,t,n){"use strict";(function(t){var r=n(8),i=n(88),o={"Content-Type":"application/x-www-form-urlencoded"};function u(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s,a={adapter:("undefined"!=typeof XMLHttpRequest?s=n(30):void 0!==t&&(s=n(30)),s),transformRequest:[function(e,t){return i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(u(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(u(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};a.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(e){a.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){a.headers[e]=r.merge(o)})),e.exports=a}).call(this,n(87))},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(13),i=n(23);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(10).Symbol;e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(45))},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return e instanceof Date}},function(e,t,n){var r=n(9),i=n(17);e.exports=function(e){var t=r(e),n=t.getFullYear(),o=new Date(0);o.setFullYear(n+1,0,4),o.setHours(0,0,0,0);var u=i(o),s=new Date(0);s.setFullYear(n,0,4),s.setHours(0,0,0,0);var a=i(s);return t.getTime()>=u.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(8),i=n(89),o=n(91),u=n(92),s=n(93),a=n(31);e.exports=function(e){return new Promise((function(t,c){var l=e.data,f=e.headers;r.isFormData(l)&&delete f["Content-Type"];var h=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",v=e.auth.password||"";f.Authorization="Basic "+btoa(d+":"+v)}if(h.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),h.timeout=e.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in h?u(h.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:e,request:h};i(t,c,r),h=null}},h.onerror=function(){c(a("Network Error",e,null,h)),h=null},h.ontimeout=function(){c(a("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",h)),h=null},r.isStandardBrowserEnv()){var y=n(94),_=(e.withCredentials||s(e.url))&&e.xsrfCookieName?y.read(e.xsrfCookieName):void 0;_&&(f[e.xsrfHeaderName]=_)}if("setRequestHeader"in h&&r.forEach(f,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete f[t]:h.setRequestHeader(t,e)})),e.withCredentials&&(h.withCredentials=!0),e.responseType)try{h.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&h.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){h&&(h.abort(),c(e),h=null)})),void 0===l&&(l=null),h.send(l)}))}},function(e,t,n){"use strict";var r=n(90);e.exports=function(e,t,n,i,o){var u=new Error(e);return r(u,t,n,i,o)}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r=n(2),i=n(15),o=n(65),u=n(66);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return u(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},function(e,t,n){"use strict";const r=()=>{const e=new Error("Delay aborted");return e.name="AbortError",e},i=({clearTimeout:e,setTimeout:t,willResolve:n})=>(i,{value:o,signal:u}={})=>{if(u&&u.aborted)return Promise.reject(r());let s,a,c;const l=e||clearTimeout,f=()=>{l(s),c(r())},h=()=>{u&&u.removeEventListener("abort",f)},d=new Promise((e,r)=>{a=()=>{h(),n?e(o):r(o)},c=r,s=(t||setTimeout)(a,i)});return u&&u.addEventListener("abort",f,{once:!0}),d.clear=()=>{l(s),s=null,h(),a()},d},o=i({willResolve:!0});o.reject=i({willResolve:!1}),o.createWithTimers=({clearTimeout:e,setTimeout:t})=>{const n=i({clearTimeout:e,setTimeout:t,willResolve:!0});return n.reject=i({clearTimeout:e,setTimeout:t,willResolve:!1}),n},e.exports=o,e.exports.default=o},function(e,t,n){var r=n(67),i=n(72),o=n(28),u=n(9),s=n(75),a=n(76);var c={M:function(e){return e.getMonth()+1},MM:function(e){return h(e.getMonth()+1,2)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},D:function(e){return e.getDate()},DD:function(e){return h(e.getDate(),2)},DDD:function(e){return r(e)},DDDD:function(e){return h(r(e),3)},d:function(e){return e.getDay()},E:function(e){return e.getDay()||7},W:function(e){return i(e)},WW:function(e){return h(i(e),2)},YY:function(e){return h(e.getFullYear(),4).substr(2)},YYYY:function(e){return h(e.getFullYear(),4)},GG:function(e){return String(o(e)).substr(2)},GGGG:function(e){return o(e)},H:function(e){return e.getHours()},HH:function(e){return h(e.getHours(),2)},h:function(e){var t=e.getHours();return 0===t?12:t>12?t%12:t},hh:function(e){return h(c.h(e),2)},m:function(e){return e.getMinutes()},mm:function(e){return h(e.getMinutes(),2)},s:function(e){return e.getSeconds()},ss:function(e){return h(e.getSeconds(),2)},S:function(e){return Math.floor(e.getMilliseconds()/100)},SS:function(e){return h(Math.floor(e.getMilliseconds()/10),2)},SSS:function(e){return h(e.getMilliseconds(),3)},Z:function(e){return f(e.getTimezoneOffset(),":")},ZZ:function(e){return f(e.getTimezoneOffset())},X:function(e){return Math.floor(e.getTime()/1e3)},x:function(e){return e.getTime()}};function l(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|]$/g,""):e.replace(/\\/g,"")}function f(e,t){t=t||"";var n=e>0?"-":"+",r=Math.abs(e),i=r%60;return n+h(Math.floor(r/60),2)+t+h(i,2)}function h(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return n}e.exports=function(e,t,n){var r=t?String(t):"YYYY-MM-DDTHH:mm:ss.SSSZ",i=(n||{}).locale,o=a.format.formatters,f=a.format.formattingTokensRegExp;i&&i.format&&i.format.formatters&&(o=i.format.formatters,i.format.formattingTokensRegExp&&(f=i.format.formattingTokensRegExp));var h=u(e);return s(h)?function(e,t,n){var r,i,o=e.match(n),u=o.length;for(r=0;r<u;r++)i=t[o[r]]||c[o[r]],o[r]=i||l(o[r]);return function(e){for(var t="",n=0;n<u;n++)o[n]instanceof Function?t+=o[n](e,c):t+=o[n];return t}}(r,o,f)(h):"Invalid Date"}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(e){return n(e)}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},r(t)}e.exports=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(19),i=n(40),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t,n){var r=n(41)(Object.keys,Object);e.exports=r},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t,n){var r=n(43),i=n(51),o=n(52),u=n(53),s=n(54),a=n(13),c=n(24),l=c(r),f=c(i),h=c(o),d=c(u),v=c(s),y=a;(r&&"[object DataView]"!=y(new r(new ArrayBuffer(1)))||i&&"[object Map]"!=y(new i)||o&&"[object Promise]"!=y(o.resolve())||u&&"[object Set]"!=y(new u)||s&&"[object WeakMap]"!=y(new s))&&(y=function(e){var t=a(e),n="[object Object]"==t?e.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case f:return"[object Map]";case h:return"[object Promise]";case d:return"[object Set]";case v:return"[object WeakMap]"}return t}),e.exports=y},function(e,t,n){var r=n(12)(n(10),"DataView");e.exports=r},function(e,t,n){var r=n(20),i=n(48),o=n(23),u=n(24),s=/^\[object .+?Constructor\]$/,a=Function.prototype,c=Object.prototype,l=a.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?h:s).test(u(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(21),i=Object.prototype,o=i.hasOwnProperty,u=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var i=u.call(e);return r&&(t?e[s]=n:delete e[s]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,i=n(49),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(10)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(12)(n(10),"Map");e.exports=r},function(e,t,n){var r=n(12)(n(10),"Promise");e.exports=r},function(e,t,n){var r=n(12)(n(10),"Set");e.exports=r},function(e,t,n){var r=n(12)(n(10),"WeakMap");e.exports=r},function(e,t,n){var r=n(56),i=n(16),o=Object.prototype,u=o.hasOwnProperty,s=o.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(e){return i(e)&&u.call(e,"callee")&&!s.call(e,"callee")};e.exports=a},function(e,t,n){var r=n(13),i=n(16);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){var n=Array.isArray;e.exports=n},function(e,t,n){var r=n(20),i=n(25);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},function(e,t,n){(function(e){var r=n(10),i=n(60),o=t&&!t.nodeType&&t,u=o&&"object"==typeof e&&e&&!e.nodeType&&e,s=u&&u.exports===o?r.Buffer:void 0,a=(s?s.isBuffer:void 0)||i;e.exports=a}).call(this,n(26)(e))},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(62),i=n(63),o=n(64),u=o&&o.isTypedArray,s=u?i(u):r;e.exports=s},function(e,t,n){var r=n(13),i=n(25),o=n(16),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!u[r(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){(function(e){var r=n(22),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,u=o&&o.exports===i&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||u&&u.binding&&u.binding("util")}catch(e){}}();e.exports=s}).call(this,n(26)(e))},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,n){var r=n(15);function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function o(t,n,u){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},function(e,t,n){var r=n(9),i=n(69),o=n(70);e.exports=function(e){var t=r(e);return o(t,i(t))+1}},function(e,t){e.exports=function(e){var t=new Date(e.getTime()),n=t.getTimezoneOffset();return t.setSeconds(0,0),6e4*n+t.getTime()%6e4}},function(e,t,n){var r=n(9);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}},function(e,t,n){var r=n(71);e.exports=function(e,t){var n=r(e),i=r(t),o=n.getTime()-6e4*n.getTimezoneOffset(),u=i.getTime()-6e4*i.getTimezoneOffset();return Math.round((o-u)/864e5)}},function(e,t,n){var r=n(9);e.exports=function(e){var t=r(e);return t.setHours(0,0,0,0),t}},function(e,t,n){var r=n(9),i=n(17),o=n(74);e.exports=function(e){var t=r(e),n=i(t).getTime()-o(t).getTime();return Math.round(n/6048e5)+1}},function(e,t,n){var r=n(9);e.exports=function(e,t){var n=t&&Number(t.weekStartsOn)||0,i=r(e),o=i.getDay(),u=(o<n?7:0)+o-n;return i.setDate(i.getDate()-u),i.setHours(0,0,0,0),i}},function(e,t,n){var r=n(28),i=n(17);e.exports=function(e){var t=r(e),n=new Date(0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),i(n)}},function(e,t,n){var r=n(27);e.exports=function(e){if(r(e))return!isNaN(e);throw new TypeError(toString.call(e)+" is not an instance of Date")}},function(e,t,n){var r=n(77),i=n(78);e.exports={distanceInWords:r(),format:i()}},function(e,t){e.exports=function(){var e={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};return{localize:function(t,n,r){var i;return r=r||{},i="string"==typeof e[t]?e[t]:1===n?e[t].one:e[t].other.replace("{{count}}",n),r.addSuffix?r.comparison>0?"in "+i:i+" ago":i}}}},function(e,t,n){var r=n(79);e.exports=function(){var e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["AM","PM"],s=["am","pm"],a=["a.m.","p.m."],c={MMM:function(t){return e[t.getMonth()]},MMMM:function(e){return t[e.getMonth()]},dd:function(e){return n[e.getDay()]},ddd:function(e){return i[e.getDay()]},dddd:function(e){return o[e.getDay()]},A:function(e){return e.getHours()/12>=1?u[1]:u[0]},a:function(e){return e.getHours()/12>=1?s[1]:s[0]},aa:function(e){return e.getHours()/12>=1?a[1]:a[0]}};return["M","D","DDD","d","Q","W"].forEach((function(e){c[e+"o"]=function(t,n){return function(e){var t=e%100;if(t>20||t<10)switch(t%10){case 1:return e+"st";case 2:return e+"nd";case 3:return e+"rd"}return e+"th"}(n[e](t))}})),{formatters:c,formattingTokensRegExp:r(c)}}},function(e,t){var n=["M","MM","Q","D","DD","DDD","DDDD","d","E","W","WW","YY","YYYY","GG","GGGG","H","HH","h","hh","m","mm","s","ss","S","SS","SSS","Z","ZZ","X","x"];e.exports=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);var i=n.concat(t).sort().reverse();return new RegExp("(\\[[^\\[]*\\])|(\\\\)?("+i.join("|")+"|.)","g")}},function(e,t){e.exports=function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t){e.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){var r=n(2);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){"use strict";var r=n(8),i=n(29),o=n(86),u=n(18);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var a=s(u);a.Axios=o,a.create=function(e){return s(r.merge(u,e))},a.Cancel=n(33),a.CancelToken=n(100),a.isCancel=n(32),a.all=function(e){return Promise.all(e)},a.spread=n(101),e.exports=a,e.exports.default=a},function(e,t){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(18),i=n(8),o=n(95),u=n(96);function s(e){this.defaults=e,this.interceptors={request:new o,response:new o}}s.prototype.request=function(e){"string"==typeof e&&(e=i.merge({url:arguments[0]},arguments[1])),(e=i.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[u,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},i.forEach(["delete","get","head","options"],(function(e){s.prototype[e]=function(t,n){return this.request(i.merge(n||{},{method:e,url:t}))}})),i.forEach(["post","put","patch"],(function(e){s.prototype[e]=function(t,n,r){return this.request(i.merge(r||{},{method:e,url:t,data:n}))}})),e.exports=s},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(e){r=u}}();var a,c=[],l=!1,f=-1;function h(){l&&a&&(l=!1,a.length?c=a.concat(c):f=-1,c.length&&d())}function d(){if(!l){var e=s(h);l=!0;for(var t=c.length;t;){for(a=c,c=[];++f<t;)a&&a[f].run();f=-1,t=c.length}a=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||l||s(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";var r=n(8);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(31);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e}},function(e,t,n){"use strict";var r=n(8);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var u=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),u.push(i(t)+"="+i(e))})))})),o=u.join("&")}return o&&(e+=(-1===e.indexOf("?")?"?":"&")+o),e}},function(e,t,n){"use strict";var r=n(8),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,u={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(u[t]&&i.indexOf(t)>=0)return;u[t]="set-cookie"===t?(u[t]?u[t]:[]).concat([n]):u[t]?u[t]+", "+n:n}})),u):u}},function(e,t,n){"use strict";var r=n(8);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(8);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,u){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===u&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r=n(8);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(8),i=n(97),o=n(32),u=n(18),s=n(98),a=n(99);function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!s(e.url)&&(e.url=a(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||u.adapter)(e).then((function(t){return c(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(c(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(8);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(33);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";n.r(t);var r=n(6),i=n.n(r),o=n(0),u=n.n(o),s=n(1),a=n.n(s),c=n(3),l=n.n(c),f=n(2),h=n.n(f),d=n(4),v=n.n(d),y=function(){function e(){u()(this,e)}return a()(e,[{key:"toObjectLiteral",value:function(){throw new Error("A class extends from ObjectLiteral must implement toObjectLiteral() method")}}]),e}(),_=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"setLastProjectionUpdatedTimestamp",value:function(e){this._lastProjectionUpdatedTimestamp=e}},{key:"requireReload",value:function(e){return!this._lastProjectionUpdatedTimestamp||this._lastProjectionUpdatedTimestamp<e}},{key:"reload",value:function(e){throw new Error("A class extends from Reloadable must implement reload(reloadedEntity) method")}}]),t}(y),p=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";u()(this,e),this._deleted=t,this._cloudEntityRelationship=n,this._errorMessageIfDeleteFailed=r}return a()(e,[{key:"isDeleted",value:function(){return this._deleted}},{key:"getCloudEntityRelationship",value:function(){return this._cloudEntityRelationship}},{key:"getErrorMessage",value:function(){return this._deleted?"":this._errorMessageIfDeleteFailed}}]),e}(),g=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";u()(this,e),this._deleted=t,this._cloudEntity=n,this._errorMessageIfDeleteFailed=r}return a()(e,[{key:"isDeleted",value:function(){return this._deleted}},{key:"getCloudEntity",value:function(){return this._cloudEntity}},{key:"getErrorMessage",value:function(){return this._deleted?"":this._errorMessageIfDeleteFailed}}]),e}(),m=Object.freeze({ACCOUNT_SERVICE:"account service",AUTHENTICATION_SERVICE:"authentication service",CLOUD_ENTITY_SERVICE:"cloud entity service",CONVERSATION_SERVICE:"conversation service",CONVERSATIONS_SERVICE:"conversations service",ENTITY_UPDATES_OBSERVER_SERVICE:"entity updates observer service",FETCH_RICH_CONTENT_SERVICE:"fetch rich content service",LOGIN_SERVICE:"login service",LOGOUT_SERVICE:"logout service",SERVER_CONFIG_SERVICE:"server config service",SECURITY_TOKEN_SERVICE:"security token service",SIGN_UP_SERVICE:"sign up service"}),k=function(){function e(t,n,r,i){u()(this,e),this._commandSubmissionService=t,this._accountFactory=n,this._securityTokenService=r,this._entityUpdatesObserverService=i}return a()(e,[{key:"createAccount",value:function(){var e=this.getCurrentStoredAccount();return e?Promise.resolve(e):this._createNewAccount()}},{key:"getCurrentStoredAccount",value:function(){return this._securityTokenService.getCurrentStoredAccount()}},{key:"clearCurrentStoredAccount",value:function(){this._securityTokenService.clearCurrentStoredAccount(),this._entityUpdatesObserverService.stopObservingEntityUpdates()}},{key:"_createNewAccount",value:function(){var e=this;return this._commandSubmissionService.submitCommand({type:"submit_access_request"}).then((function(t){var n=e._createAccountFrom(t);return e._securityTokenService.storeAccount(n,n.getInitialSecurityToken()),e._entityUpdatesObserverService.startObservingEntityUpdates(n),n}))}},{key:"_createAccountFrom",value:function(e){var t=e.payload.owner_id;return this._accountFactory.create(t,e)}}]),e}(),S=function(){function e(t,n){u()(this,e),this._signUpService=t,this._loginService=n}return a()(e,[{key:"authenticate",value:function(e){var t=this;return this._signUpService.signUp(e).catch((function(n){return t._loginService.login(e)}))}}]),e}(),O=n(7),b=n.n(O);function E(e){return b()(e)?e:e.trim()}function C(e){return b()(e)?"":e.trim()}function T(e){return!b()(e)}var w=n(34),I=function(e){function t(e,n,r){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return u()(this,t),(i=l()(this,h()(t).call(this)))._errorCode=e,i._errorMessages=n,i._requestUrl=r,i._requestPayload=o,i._error=s,i}return v()(t,e),a()(t,[{key:"toObjectLiteral",value:function(){return{errorCode:this._errorCode,errorMessages:this._errorMessages,requestUrl:this._requestUrl,requestPayload:this._requestPayload}}},{key:"errorCode",get:function(){return this._errorCode}},{key:"errorMessages",get:function(){return this._errorMessages}},{key:"requestUrl",get:function(){return this._requestUrl}},{key:"requestPayload",get:function(){return this._requestPayload}},{key:"error",get:function(){return this._error}},{key:"message",get:function(){return"Error code ".concat(this._errorCode,": ").concat(this._errorMessages[0]," for url: ").concat(this._requestUrl)}}]),t}(n.n(w)()(Error)),A=function(){function e(t,n,r){u()(this,e),this._networkClient=t,this._clientServiceLoginUrl=n,this._clientServiceSignUpUrl=r}return a()(e,[{key:"login",value:function(e){return this._requestAuthentication(this.getLoginUrl(),e)}},{key:"signUp",value:function(e,t){return this._requestAuthentication(this.getSignUpUrl(),e,t)}},{key:"getLoginUrl",value:function(){return this._clientServiceLoginUrl}},{key:"getSignUpUrl",value:function(){return this._clientServiceSignUpUrl}},{key:"_requestAuthentication",value:function(e,t,n){var r=this,i=this._createRequestHeaders(n);return this._networkClient.doPost(e,t,i).then((function(e){var t=e.data;return Promise.resolve(t)})).catch((function(n){return n.response?Promise.reject(r._createRequestError(n.response,e,t)):Promise.reject(r._createUnknownError(n,e,t))}))}},{key:"_createRequestHeaders",value:function(e){var t={};return T(e)&&(t.Authorization="Token token=".concat(e)),t}},{key:"_createRequestError",value:function(e,t,n){var r=e.status,i=e.statusText;return new I(r,[i],t,n)}},{key:"_createUnknownError",value:function(e,t,n){return new I(-1,[e.message],t,n)}}]),e}(),j=function(){function e(t,n,r,i,o){u()(this,e),this._secureFetchEntityService=t,this._secureCommandSubmissionService=n,this._cloudEntityFactory=r,this._cloudRelatedEntitiesFactory=i,this._cloudEntitiesCache=o}return a()(e,[{key:"fetchCloudEntity",value:function(e){var t=this;return this._secureFetchEntityService.fetch("fetch cloud entity","cloud_entity",e).then((function(e){var n=t._createAndCacheCloudEntity(e);return Promise.resolve(n)}))}},{key:"fetchCloudRelatedEntities",value:function(e,t){var n=this;return this._secureFetchEntityService.fetch("fetch cloud related entities",t,e).then((function(e){var t=n._cloudRelatedEntitiesFactory.create(e);return Promise.resolve(t)}))}},{key:"deleteCloudRelatedEntity",value:function(e,t,n,r,i){var o={type:"delete_related_entity",owner_entity_id:e,owner_entity_type:t,related_entity_id:n,related_entity_type:r,relationship_type:i};return this._secureCommandSubmissionService.submitCommand("delete related entity",o)}},{key:"deleteCloudEntityAttribute",value:function(e,t,n){var r={type:"delete_cloud_entity_attribute",id:e,cloud_entity_type:t,attribute_name:n};return this._secureCommandSubmissionService.submitCommand("delete cloud entity attribute",r)}},{key:"findCloudEntity",value:function(e){return this._cloudEntitiesCache.lookupCloudEntity(e)}},{key:"findOrFetchCloudEntity",value:function(e){var t=this.findCloudEntity(e);return t?Promise.resolve(t):this.fetchCloudEntity(e)}},{key:"removeCloudEntityFromCache",value:function(e){this._cloudEntitiesCache.removeCloudEntity(e)}},{key:"getCloudEntitiesCacheLiteral",value:function(){return this._cloudEntitiesCache.toObjectLiteral()}},{key:"_createAndCacheCloudEntity",value:function(e){var t=this._cloudEntityFactory.create(e);return this._cloudEntitiesCache.cacheCloudEntity(t)}}]),e}(),R=n(35),U=n.n(R);function D(e){return U()(e)}function P(e){return N(e,"self")}function F(e){return L(function(e){return N(e,"home")}(e))}function M(e){return L(function(e){return N(e,"conversations")}(e))}function L(e){return e.substring(e.indexOf("id=")+"id=".length,e.length)}function N(e,t){var n=function(e,t){return e.find((function(e){return e.rel===t}))}(e,t);return n?n.href:""}var x=n(36),V=n.n(x),q=n(9),H=n.n(q);function Y(){return Date.now()}function B(){return W(Y())}function K(e){return Y()+e}function W(e){var t=V()(e,"YYYY-MM-DDTHH:mm:ssZ"),n=Intl.DateTimeFormat().resolvedOptions().timeZone;return"".concat(t,"[").concat(n,"]")}function G(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=new Date(e,t,n,r,i,o);return Z(u),u}function X(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=new Date(e,t,n,r,i,o);return Z(u),u.getTime()}function $(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=new Date(e,t,n,r,i,o);return Z(u),W(u)}function z(e){return W(new Date(e))}function Z(e){if(isNaN(e.getTime()))throw new Error("Invalid Date")}var J=function(){function e(t,n,r,i){u()(this,e),this._networkClient=t,this._platformServiceUrl=n,this._requestTimeOutInMilliseconds=r,this._requestTimeOutBasedInspector=i}return a()(e,[{key:"scheduleSubmitCommand",value:function(e,t,n){var r=this;return D(e).then((function(){return r.submitCommand(t,n)}))}},{key:"submitCommand",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._requestTimeOutBasedInspector,i=this.getSubmitCommandUrl(),o=this._createRequestHeaders(n);return this._networkClient.doPost(i,e,o).then((function(i){var o=i.data;if(t._isEntityAvailable(o))return Promise.resolve(o);var u=P(o.links),s=o.security_token,a=T(s)?s:n;return t._followUp(e,u,a,1,t._calculateTimeOutTime(),r)})).catch((function(n){return t._rejectError(n,i,e)}))}},{key:"followUpOnSubmittedCommand",value:function(e,t){var n=this,r={};return this._followUp(r,e,t,0,this._calculateTimeOutTime(),this._requestTimeOutBasedInspector).catch((function(t){return n._rejectError(t,e,r)}))}},{key:"getSubmitCommandUrl",value:function(){return"".concat(this._platformServiceUrl,"/c")}},{key:"_followUp",value:function(e,t,n,r,i,o){var u=this,s=this._calculateBackoffInterval(o,r);return o.shouldStopToFollowUp(i)?o.onStopToFollowUp(t,e):D(s).then((function(){return u._networkClient.doGet(t,u._createRequestHeaders(n)).then((function(s){var a=s.data;return u._isEntityAvailable(a)?Promise.resolve(a):u._isEntityError(a)?Promise.reject(u._createEntityError(a,t,e)):u._followUp(e,t,n,r+1,i,o)}))}))}},{key:"_rejectError",value:function(e,t,n){return e instanceof I?Promise.reject(e):e.response?Promise.reject(this._createRequestError(e.response,t,n)):Promise.reject(this._createUnknownError(e,t,n))}},{key:"_isEntityAvailable",value:function(e){return"ready"===this._getResponseStatus(e)}},{key:"_isEntityError",value:function(e){return"error"===this._getResponseStatus(e)}},{key:"_getResponseStatus",value:function(e){return e.status}},{key:"_createRequestHeaders",value:function(e){var t={};return T(e)&&(t.Authorization="Token token=".concat(e)),t}},{key:"_calculateBackoffInterval",value:function(e,t){return e.calculateBackoffInterval(t)}},{key:"_calculateTimeOutTime",value:function(){return K(this._requestTimeOutInMilliseconds)}},{key:"_createRequestError",value:function(e,t,n){var r=e.status,i=e.statusText;return new I(r,[i],t,n)}},{key:"_createEntityError",value:function(e,t,n){if(b()(e.payload))return this._createUnknownError(e,t,n);var r=e.payload,i=r.code,o=r.message;return new I(i,[o],t,n)}},{key:"_createUnknownError",value:function(e,t,n){return new I(-1,[e.message],t,n)}}]),e}(),Q=function(){function e(){u()(this,e)}return a()(e,[{key:"calculateBackoffInterval",value:function(e){throw new Error("Follow up inspector must implement calculateBackoffInterval() method")}},{key:"shouldStopToFollowUp",value:function(e){throw new Error("Follow up inspector must implement shouldStopToFollowUp() method")}},{key:"onStopToFollowUp",value:function(e,t,n){}}]),e}(),ee=function(e){function t(e,n,r,i){var o;return u()(this,t),(o=l()(this,h()(t).call(this)))._securityTokenService=e,o._followUpAccountId=n,o._conversation=r,o._backoffInterval=i,o}return v()(t,e),a()(t,[{key:"calculateBackoffInterval",value:function(e){return this._backoffInterval}},{key:"shouldStopToFollowUp",value:function(e){return this._isCurrentStoredAccountRemovedOrModified()||this._isConversationNotConnectingToLiveAgent()}},{key:"_isConversationNotConnectingToLiveAgent",value:function(){return!this._conversation.isConnectingToLiveAgent()}},{key:"_isCurrentStoredAccountRemovedOrModified",value:function(){var e=this._securityTokenService.getCurrentStoredAccountId();return!e||e!==this._followUpAccountId}}]),t}(Q);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ne=function(){function e(t,n,r,i,o,s,a){u()(this,e),this._secureCommandSubmissionService=t,this._secureFetchEntityService=n,this._securityTokenService=r,this._richContentOptionsLoader=i,this._conversationFactory=o,this._conversationsCache=s,this._backoffIntervalOnWaitingLiveAgentResponse=a}return a()(e,[{key:"startConversation",value:function(e){var t=this,n={type:"start_conversation",intent:e,time:B()};return this._secureCommandSubmissionService.submitCommand("start conversation",n).then((function(e){return t._richContentOptionsLoader.loadRichContentOptions(e)})).then((function(e){var n=t._createAndCacheConversation(e);return Promise.resolve(n)}))}},{key:"startConversationWithRecognisedIntent",value:function(e){var t=this,n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{type:"start_conversation_with_recognised_intent"});return this._secureCommandSubmissionService.submitCommand("start conversation with recognised intent",n).then((function(e){return t._richContentOptionsLoader.loadRichContentOptions(e)})).then((function(e){var n=t._createAndCacheConversation(e);return Promise.resolve(n)}))}},{key:"fetchConversation",value:function(e){var t=this;return this._secureFetchEntityService.fetch("fetch conversation","conversation",e).then((function(e){return t._richContentOptionsLoader.loadRichContentOptions(e)})).then((function(e){var n=t._createAndCacheConversation(e);return Promise.resolve(n)}))}},{key:"answerInteraction",value:function(e,t,n){var r=this,i=this._createSubmitAnswerPayload(e,t,n);return this._secureCommandSubmissionService.submitCommand("answer interaction",i).then((function(e){return r._richContentOptionsLoader.loadRichContentOptions(e)})).then((function(e){var t=r._createAndCacheConversation(e);return Promise.resolve(t)}))}},{key:"answerLiveAgent",value:function(e,t,n){var r=this,i=this._createSubmitAnswerPayload(e.getId(),t,n),o=this._securityTokenService.getCurrentStoredAccountId(),u=new ee(this._securityTokenService,o,e,this._backoffIntervalOnWaitingLiveAgentResponse);return this._secureCommandSubmissionService.submitCommand("answer live agent",i,u).then((function(t){if(t){var n=r._createAndCacheConversation(t);return Promise.resolve(n)}return Promise.resolve(e)}))}},{key:"connectToLiveAgent",value:function(e){var t=this,n={id:e,type:"calling_live_agent"};return this._secureCommandSubmissionService.submitCommand("connect to live agent",n).then((function(e){var n=t._createAndCacheConversation(e);return Promise.resolve(n)}))}},{key:"disconnectFromLiveAgent",value:function(e){var t=this,n={id:e,type:"user_initiated_disconnecting_live_agent"};return this._secureCommandSubmissionService.submitCommand("disconnect from live agent",n).then((function(e){var n=t._createAndCacheConversation(e);return Promise.resolve(n)}))}},{key:"findConversation",value:function(e){return this._conversationsCache.lookupConversation(e)}},{key:"findOrFetchConversation",value:function(e){var t=this._conversationsCache.lookupConversation(e);return t?t.refresh().then((function(e){return Promise.resolve(t)})):this.fetchConversation(e)}},{key:"getConversationsCacheLiteral",value:function(){return this._conversationsCache.toObjectLiteral()}},{key:"_createSubmitAnswerPayload",value:function(e,t,n){return{id:e,interaction_id:t,type:"answer_interaction",time:B(),answer:n}}},{key:"_createAndCacheConversation",value:function(e){var t=this._conversationFactory.create(e);return this._conversationsCache.cacheConversation(t)}}]),e}(),re=function(){function e(t,n,r){u()(this,e),this._conversationsCache=t,this._conversationsService=n,this._onConversationsUpdated=r}return a()(e,[{key:"observeUpdates",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],i=t._conversationsCache.getConversations();if(i&&i.getId()===n&&i.requireReload(r))return t._conversationsService.fetchConversations(n).then((function(e){e.setLastProjectionUpdatedTimestamp(r),t._onConversationsUpdated(e)}))}))}}]),e}(),ie=n(11),oe=n.n(ie),ue=function(){function e(t,n,r){u()(this,e),this._cloudEntitiesCache=t,this._cloudEntityService=n,this._onCloudEntityUpdated=r}return a()(e,[{key:"observeUpdates",value:function(e){var t=this;this._removeDeletedCloudEntitiesFromCache(e),Object.keys(e).forEach((function(n){var r=e[n],i=t._cloudEntitiesCache.lookupCloudEntity(n);if(i&&i.requireReload(r))return t._cloudEntityService.fetchCloudEntity(n).then((function(e){e.setLastProjectionUpdatedTimestamp(r),t._onCloudEntityUpdated(e)}))}))}},{key:"_removeDeletedCloudEntitiesFromCache",value:function(e){var t=this,n=this._cloudEntitiesCache.getCloudEntities();oe()(n.keys()).forEach((function(n){e[n]||t._cloudEntitiesCache.removeCloudEntity(n)}))}}]),e}(),se=function(){function e(t,n,r){u()(this,e),this._cloudEntitiesCache=t,this._cloudEntityService=n,this._onCloudEntityRelationshipUpdated=r}return a()(e,[{key:"observeUpdates",value:function(e,t){var n=this;Object.keys(t).forEach((function(r){var i=t[r],o=n._cloudEntitiesCache.lookupCloudEntity(r);if(o){var u=o.getRelationshipByName(e);if(u&&u.requireReload(i))return n._cloudEntityService.fetchCloudRelatedEntities(r,u.getType()).then((function(e){u.reload(e),u.setLastProjectionUpdatedTimestamp(i),n._onCloudEntityRelationshipUpdated(u)}))}}))}}]),e}(),ae=function(){function e(t,n,r){u()(this,e),this._conversationsCache=t,this._conversationService=n,this._onConversationUpdated=r}return a()(e,[{key:"observeUpdates",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],i=t._conversationsCache.lookupConversation(n);if(i&&i.requireReload(r))return t._conversationService.fetchConversation(n).then((function(e){e.setLastProjectionUpdatedTimestamp(r),t._onConversationUpdated(e)}))}))}}]),e}(),ce=function(){function e(t,n,r,i){u()(this,e),this._conversationsUpdatesObserver=t,this._conversationUpdatesObserver=n,this._cloudEntityUpdatesObserver=r,this._cloudEntityRelationshipUpdatesObserver=i}return a()(e,[{key:"observeEntityUpdates",value:function(e){this._observeConversationsUpdates(e.conversations),this._observeConversationUpdates(e.conversation),this._observeCloudEntityUpdates(e.cloud_entity),this._observeCloudEntityRelationshipUpdates(e)}},{key:"_observeConversationsUpdates",value:function(e){this._conversationsUpdatesObserver.observeUpdates(e||{})}},{key:"_observeConversationUpdates",value:function(e){this._conversationUpdatesObserver.observeUpdates(e||{})}},{key:"_observeCloudEntityUpdates",value:function(e){this._cloudEntityUpdatesObserver.observeUpdates(e)}},{key:"_observeCloudEntityRelationshipUpdates",value:function(t){var n=this;Object.keys(t).filter((function(t){return t.startsWith(e.CLOUD_ENTITY_RELATIONSHIP_PREFIX)})).forEach((function(e){var r=n._extractCloudEntityRelationshipName(e),i=t[e];n._cloudEntityRelationshipUpdatesObserver.observeUpdates(r,i)}))}},{key:"_extractCloudEntityRelationshipName",value:function(t){var n=e.CLOUD_ENTITY_RELATIONSHIP_PREFIX,r=t.indexOf(n)+n.length;return t.substring(r,t.length)}}],[{key:"CLOUD_ENTITY_RELATIONSHIP_PREFIX",get:function(){return"cloud_entity_relationship_"}}]),e}(),le=function(){function e(){u()(this,e)}return a()(e,null,[{key:"logError",value:function(e){console.error(e)}},{key:"logInfo",value:function(e){console.log(e)}}]),e}(),fe=function(){function e(t,n,r,i,o,s,a,c){u()(this,e),this._cloudEntityService=t,this._conversationsService=n,this._securityTokenService=r,this._fetchEntityUpdatesService=i,this._entityUpdatesObserver=o,this._conversationsCache=s,this._cloudEntitiesCache=a,this._detectEntityUpdatesIntervalInMilliseconds=c}return a()(e,[{key:"startObservingEntityUpdates",value:function(e){var t=this;return this._running=!0,this._resetCaches(),this._loadAccountCloudEntity(e).then((function(n){return t._loadAccountConversations(e)})).then((function(n){return t._scheduleEntityUpdatesTask(e,0)})).catch((function(e){return le.logInfo(e.message),Promise.resolve()}))}},{key:"stopObservingEntityUpdates",value:function(){this._resetCaches(),this._running=!1}},{key:"_loadAccountCloudEntity",value:function(e){var t=e.getId();return this._isCurrentStoredAccountExistsAndItsIdSameAsCurrentObservingAccountId(t)?this._cloudEntityService.fetchCloudEntity(e.getCloudEntityId()):Promise.reject(this._getStopObservingMessage(t))}},{key:"_loadAccountConversations",value:function(e){var t=e.getId();return this._isCurrentStoredAccountExistsAndItsIdSameAsCurrentObservingAccountId(t)?this._conversationsService.fetchConversations(e.getConversationsId()):Promise.reject(this._getStopObservingMessage(t))}},{key:"_scheduleEntityUpdatesTask",value:function(e,t){var n=this;return D(t).then((function(){var t=e.getId();return n._running&&n._isCurrentStoredAccountExistsAndItsIdSameAsCurrentObservingAccountId(t)?n._fetchEntityUpdatesService.fetch().then((function(e){n._entityUpdatesObserver.observeEntityUpdates(e)})).catch((function(e){le.logInfo(e.message)})).finally((function(){return n._scheduleEntityUpdatesTask(e,n._detectEntityUpdatesIntervalInMilliseconds)})):Promise.reject(n._getStopObservingMessage(t))}))}},{key:"_isCurrentStoredAccountExistsAndItsIdSameAsCurrentObservingAccountId",value:function(e){var t=this._securityTokenService.getCurrentStoredAccount();return t&&t.getId()===e}},{key:"_resetCaches",value:function(){this._conversationsCache.clear(),this._cloudEntitiesCache.clear()}},{key:"_getStopObservingMessage",value:function(e){return new Error("Observing updates for account id: ".concat(e," is stopped."))}}]),e}(),he=function(){function e(t,n,r){u()(this,e),this._platformServiceUrl=t,this._fetchEntityService=n,this._securityTokenService=r}return a()(e,[{key:"fetch",value:function(){var e=this._getFetchUrl();return this._securityTokenService.isCurrentAccountSecurityTokenValid()?this._fetchEntityService.fetch(e,this._getCurrentAccountSecurityToken()):Promise.reject(this._createSecurityTokenError(e))}},{key:"_getCurrentAccountSecurityToken",value:function(){return this._securityTokenService.getCurrentStoredSecurityToken().getToken()}},{key:"_getFetchUrl",value:function(){return"".concat(this._platformServiceUrl,"/s")}},{key:"_createSecurityTokenError",value:function(e){return new I(401,["Failed to fetch entity updates. Security token is either expired or not exist."],e)}}]),e}(),de=function(){function e(t,n,r){u()(this,e),this._secureFetchEntityService=t,this._conversationsFactory=n,this._conversationsCache=r}return a()(e,[{key:"fetchConversations",value:function(e){var t=this;return this._secureFetchEntityService.fetch("fetch conversations","conversations",e).then((function(e){var n=t._conversationsFactory.create(e),r=t._conversationsCache.cacheConversations(n);return Promise.resolve(r)}))}},{key:"findOrFetchConversations",value:function(e){var t=this._conversationsCache.getConversations();return t?Promise.resolve(t):this.fetchConversations(e)}}]),e}(),ve=function(){function e(t,n,r){u()(this,e),this._networkClient=t,this._requestTimeOutInMilliseconds=n,this._requestTimeOutBasedInspector=r}return a()(e,[{key:"fetch",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return this._followUp(e,n,0,this._calculateTimeOutTime()).catch((function(n){return n instanceof I?Promise.reject(n):n.response?Promise.reject(t._createRequestError(n.response,e)):Promise.reject(t._createUnknownError(n,e))}))}},{key:"_followUp",value:function(e,t,n,r){var i=this,o=this._calculateBackoffInterval(n);return this._requestTimeOutBasedInspector.shouldStopToFollowUp(r)?this._requestTimeOutBasedInspector.onStopToFollowUp(e):D(o).then((function(){return i._networkClient.doGet(e,i._createRequestHeaders(t)).then((function(e){return Promise.resolve(e.data)})).catch((function(o){return i._isEntityNotAvailableYet(o)?i._followUp(e,t,n+1,r):Promise.reject(o)}))}))}},{key:"_isEntityNotAvailableYet",value:function(e){return e.response&&404===e.response.status}},{key:"_createRequestHeaders",value:function(e){var t={};return T(e)&&(t.Authorization="Token token=".concat(e)),t}},{key:"_calculateBackoffInterval",value:function(e){return this._requestTimeOutBasedInspector.calculateBackoffInterval(e)}},{key:"_calculateTimeOutTime",value:function(){return K(this._requestTimeOutInMilliseconds)}},{key:"_createRequestError",value:function(e,t){var n=e.status,r=e.statusText;return new I(n,[r],t)}},{key:"_createUnknownError",value:function(e,t){return new I(-1,[e.message],t)}}]),e}(),ye=function(){function e(t,n){u()(this,e),this._platformServiceUrl=t,this._secureCommandSubmissionService=n}return a()(e,[{key:"fetch",value:function(e){var t=this,n=this._getFetchUrl(e);return this._secureCommandSubmissionService.followUpOnSubmittedCommand("fetch rich content link",n).then((function(e){return t._createSucceededResult(e)})).catch((function(e){return t._createFailedResult(e.message)}))}},{key:"_getFetchUrl",value:function(e){return"".concat(this._platformServiceUrl).concat(e)}},{key:"_createSucceededResult",value:function(e){return Promise.resolve({succeeded:!0,response:e})}},{key:"_createFailedResult",value:function(e){return Promise.resolve({succeeded:!1,errorMessage:e})}}]),e}(),_e=n(5),pe=n.n(_e),ge=function(e){function t(e,n,r,i,o,s,a,c){var f;return u()(this,t),(f=l()(this,h()(t).call(this)))._id=e,f._hint=n,f._description=r,f._type=i,f._errorMessages=o,f._required=s,f._answer=a,f._answerValidator=c,f}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getHint",value:function(){return this._hint}},{key:"getDescription",value:function(){return this._description}},{key:"getType",value:function(){return this._type}},{key:"getErrorMessages",value:function(){return this._errorMessages}},{key:"isRequired",value:function(){return this._required}},{key:"getAnswer",value:function(){return this._answer}},{key:"getSubmittedAnswer",value:function(){throw new Error("Field must implement getSubmittedAnswer() method")}},{key:"validate",value:function(){return this._answerValidator.validate(this._answer)}},{key:"reload",value:function(e){return this._answer=e.getAnswer(),this}},{key:"refresh",value:function(){return Promise.resolve(this)}},{key:"toObjectLiteral",value:function(){return{id:this._id,hint:this._hint,description:this._description,type:this._type,errorMessages:this._errorMessages,required:this._required,answer:this._answer}}}]),t}(y),me=Object.freeze({CONFIRM_DETAILS_FIELD:"confirmDetails",CONFIRMATION_FIELD:"confirmation",CURRENCY_FIELD:"currency",DATE_FIELD:"date",EMAIL_FIELD:"email",MULTI_SELECT_CHOICES_FIELD:"multiSelectChoices",MULTI_SELECT_CHOICES_WITH_RICH_CONTENT_FIELD:"multiSelectChoicesWithRichContent",MULTIPLE_CHOICES_FIELD:"multipleChoices",MULTIPLE_CHOICES_WITH_OTHER_FIELD:"multipleChoicesWithOther",MULTIPLE_CHOICES_WITH_RICH_CONTENT_FIELD:"multipleChoicesWithRichContent",NUMBER_FIELD:"number",START_NEW_CONVERSATION_WITH_INTENT_FIELD:"startNewConversationWithIntent",TEXT_FIELD:"text"});function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Se=function(e){function t(e,n,r,i,o,s,a,c,f,d,v,y,_,p,g){var m;return u()(this,t),(m=l()(this,h()(t).call(this,e,n,r,me.MULTIPLE_CHOICES_WITH_RICH_CONTENT_FIELD,i,o,d,v)))._defaultValue=s,m._contentType=a,m._choices=c,m._emptyOptionsMessage=f,m._selectedChoice=d,m._fetchType=y,m._fetchUrl=_,m._isFetchSucceeded=p,m._fetchErrorMessage=g,m}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getContentType",value:function(){return this._contentType}},{key:"getRichContentChoices",value:function(){var e=this;return this._fetchChoices().then((function(t){return Promise.resolve(e._choices)}))}},{key:"getEmptyOptionsMessage",value:function(){return this._emptyOptionsMessage}},{key:"isFetchSucceeded",value:function(){return this._isFetchSucceeded}},{key:"getFetchErrorMessage",value:function(){return this._fetchErrorMessage}},{key:"choose",value:function(e){this._answer=e;var n=pe()(h()(t.prototype),"validate",this).call(this);return this._selectedChoice=n.isValid()?this._choices[e]:void 0,n}},{key:"getSubmittedAnswer",value:function(){return this._selectedChoice}},{key:"refresh",value:function(){return this._fetchChoices()}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{answer:this.getSubmittedAnswer(),submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,contentType:this._contentType,choices:this._choices,emptyOptionsMessage:this._emptyOptionsMessage,fetchType:this._fetchType,fetchUrl:this._fetchUrl,fetchSucceeded:this._isFetchSucceeded,fetchErrorMessage:this._fetchErrorMessage})}},{key:"_fetchChoices",value:function(){var e=this;return this._isFetchFailed()?this._getFetchRichContentService().fetch(this._fetchUrl).then((function(t){return e._updateWithFetchResult(t),Promise.resolve(e)})):Promise.resolve(this)}},{key:"_isFetchFailed",value:function(){return this._fetchType===t.FETCH_FROM_URL_TYPE&&!this._isFetchSucceeded}},{key:"_updateWithFetchResult",value:function(e){if(e.succeeded){var t=e.richContentData;this._choices.splice(0,this._choices.length),this._choices=this._choices.concat(t),this._answerValidator.updateNumberOfChoices(t.length)}this._isFetchSucceeded=e.succeeded,this._fetchErrorMessage=e.errorMessage}},{key:"_getFetchRichContentService",value:function(){return vn.getFetchRichContentService()}}],[{key:"FETCH_FROM_URL_TYPE",get:function(){return"fetchFromUrl"}}]),t}(ge),Oe=function(){function e(t,n,r,i){u()(this,e),this._networkClient=t,this._fetchRichContentLinkService=n,this._requestTimeOutInMilliseconds=r,this._requestTimeOutBasedInspector=i}return a()(e,[{key:"fetch",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._fetchRichContentLinkService.fetch(e).then((function(e){return e.succeeded?t._fetchRichContentOptions(r,n,e.response):t._createFailedResult(r,n,e.errorMessage)}))}},{key:"_fetchRichContentOptions",value:function(e,t,n){if(n.type===Se.FETCH_FROM_URL_TYPE){var r=n.data,i=r.url,o=r.headers;return this._followUp(e,t,i,o,0,this._calculateTimeOutTime())}return this._createSucceededResult(e,t,n.data)}},{key:"_followUp",value:function(e,t,n,r,i,o){var u=this,s=this._calculateBackoffInterval(i);return this._requestTimeOutBasedInspector.shouldStopToFollowUp(o)?this._requestTimeOutBasedInspector.onStopToFollowUp(n).catch((function(n){return u._createFailedResult(e,t,n.message)})):D(s).then((function(){return u._networkClient.doGet(n,r).then((function(n){return u._createSucceededResult(e,t,n.data)})).catch((function(s){if(u._isOptionsNotAvailableYet(s))return u._followUp(e,t,n,r,i+1,o);var a=u._createFetchError(s,n);return u._createFailedResult(e,t,a.message)}))}))}},{key:"_isOptionsNotAvailableYet",value:function(e){return e.response&&404===e.response.status}},{key:"_createSucceededResult",value:function(e,t,n){return Promise.resolve({interactionId:e,interactionFieldId:t,succeeded:!0,richContentData:n})}},{key:"_createFailedResult",value:function(e,t,n){return Promise.resolve({interactionId:e,interactionFieldId:t,succeeded:!1,errorMessage:n})}},{key:"_calculateBackoffInterval",value:function(e){return this._requestTimeOutBasedInspector.calculateBackoffInterval(e)}},{key:"_calculateTimeOutTime",value:function(){return K(this._requestTimeOutInMilliseconds)}},{key:"_createFetchError",value:function(e,t){return e instanceof I?e:e.response?this._createRequestError(e.response,t):this._createUnknownError(e,t)}},{key:"_createRequestError",value:function(e,t){var n=e.status,r=e.statusText;return new I(n,[r],t)}},{key:"_createUnknownError",value:function(e,t){return new I(-1,[e.message],t)}}]),e}(),be=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._profile=e,r._account=n,r}return v()(t,e),a()(t,[{key:"getProfile",value:function(){return this._profile}},{key:"getAccount",value:function(){return this._account}},{key:"toObjectLiteral",value:function(){return{profile:this._profile,account:this._account.toObjectLiteral()}}}]),t}(y),Ee=function(){function e(t,n,r,i,o){u()(this,e),this._commandSubmissionService=t,this._clientAuthenticationService=n,this._accountFactory=r,this._securityTokenService=i,this._entityUpdatesObserverService=o}return a()(e,[{key:"login",value:function(e){var t=this;return this._clientAuthenticationService.login(e).then((function(n){return n.success?t._followUpOnLogin(n):t._failOnLogin(e,n.errors)})).then((function(e){return t._storeAccountAndCreateUser(e)}))}},{key:"_followUpOnLogin",value:function(e){var t=e.profile,n=e.payload,r=P(n.links),i=n.security_token;return this._commandSubmissionService.followUpOnSubmittedCommand(r,i).then((function(e){return Promise.resolve({userProfile:t,loginCompletionResponse:e})}))}},{key:"_failOnLogin",value:function(e,t){var n=new I(403,t,this._clientAuthenticationService.getLoginUrl(),e);return Promise.reject(n)}},{key:"_storeAccountAndCreateUser",value:function(e){var t=e.loginCompletionResponse,n=t.payload.account_id,r=this._accountFactory.create(n,t),i=e.userProfile;return this._securityTokenService.storeAccount(r,r.getInitialSecurityToken()),this._entityUpdatesObserverService.startObservingEntityUpdates(r),new be(i,r)}}]),e}(),Ce=function(){function e(t,n,r){u()(this,e),this._secureCommandSubmissionService=t,this._securityTokenService=n,this._entityUpdatesObserverService=r}return a()(e,[{key:"logout",value:function(){var e=this;return this._secureCommandSubmissionService.submitCommand("logout",{type:"logout"}).then((function(){return Promise.resolve()})).catch((function(e){return Promise.reject(e)})).finally((function(){e._securityTokenService.clearCurrentStoredAccount(),e._entityUpdatesObserverService.stopObservingEntityUpdates()}))}}]),e}(),Te=function(){function e(t){u()(this,e),this._fetchRichContentService=t}return a()(e,[{key:"loadRichContentOptions",value:function(e){var t=this,n=this._buildFetchRichContentFieldPromises(e);return Promise.all(n).then((function(n){return t._populateRichContentFieldOptions(e,n),Promise.resolve(e)}))}},{key:"_buildFetchRichContentFieldPromises",value:function(e){var t=this,n=[];return e.payload.interactions.forEach((function(e){var r=e.data;Object.values(r).forEach((function(r){if(r.type===me.MULTIPLE_CHOICES_WITH_RICH_CONTENT_FIELD||r.type===me.MULTI_SELECT_CHOICES_WITH_RICH_CONTENT_FIELD){var i=r.options;if(i.type===Se.FETCH_FROM_URL_TYPE){var o=r.id,u=i.url,s=Promise.resolve(t._fetchRichContentService.fetch(u,o,e.id));n.push(s)}else i.fetchSucceeded=!0}}))})),n}},{key:"_populateRichContentFieldOptions",value:function(e,t){var n=!0,r=!1,i=void 0;try{for(var o,u=function(){var t=o.value,n=t.interactionId,r=t.interactionFieldId,i=e.payload.interactions.find((function(e){return e.id===n})).data[r].options;i.data=t.succeeded?t.richContentData:[],i.fetchSucceeded=t.succeeded,i.fetchErrorMessage=t.errorMessage},s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)u()}catch(e){r=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}]),e}(),we=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._sampleQuestions=e,r._liveAgentEnabled=n,r}return v()(t,e),a()(t,[{key:"getSampleQuestions",value:function(){return this._sampleQuestions}},{key:"isLiveAgentEnabled",value:function(){return this._liveAgentEnabled}},{key:"toObjectLiteral",value:function(){return{sampleQuestions:this._sampleQuestions,liveAgentEnabled:this._liveAgentEnabled}}}]),t}(y),Ie=function(){function e(t,n){u()(this,e),this._platformServiceUrl=t,this._fetchEntityService=n}return a()(e,[{key:"retrieveConfig",value:function(){return this._fetchEntityService.fetch(this._getFetchUrl()).then((function(e){var t=e.payload;return new we(t.sample_questions,t.live_agent_enabled)}))}},{key:"_getFetchUrl",value:function(){return"".concat(this._platformServiceUrl,"/api")}}]),e}(),Ae=function(){function e(t,n){u()(this,e),this._commandSubmissionService=t,this._securityTokenService=n}return a()(e,[{key:"submitCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this._securityTokenService.isCurrentAccountSecurityTokenValid()?this._commandSubmissionService.submitCommand(t,this._getCurrentAccountSecurityToken(),n):Promise.reject(this._createSecurityTokenError(e,this._getSubmitCommandUrl(),t))}},{key:"followUpOnSubmittedCommand",value:function(e,t){return this._securityTokenService.isCurrentAccountSecurityTokenValid()?this._commandSubmissionService.followUpOnSubmittedCommand(t,this._getCurrentAccountSecurityToken()):Promise.reject(this._createSecurityTokenError(e,t,{}))}},{key:"_getCurrentAccountSecurityToken",value:function(){return this._securityTokenService.getCurrentStoredSecurityToken().getToken()}},{key:"_getSubmitCommandUrl",value:function(){return this._commandSubmissionService.getSubmitCommandUrl()}},{key:"_createSecurityTokenError",value:function(e,t,n){var r="Failed to ".concat(e,". Security token is either expired or not exist.");return new I(401,[r],t,n)}}]),e}(),je=function(){function e(t,n,r){u()(this,e),this._platformServiceUrl=t,this._fetchEntityService=n,this._securityTokenService=r}return a()(e,[{key:"fetch",value:function(e,t,n){var r=this._getFetchUrl(t,n);return this._securityTokenService.isCurrentAccountSecurityTokenValid()?this._fetchEntityService.fetch(r,this._getCurrentAccountSecurityToken()):Promise.reject(this._createSecurityTokenError(e,r))}},{key:"_getCurrentAccountSecurityToken",value:function(){return this._securityTokenService.getCurrentStoredSecurityToken().getToken()}},{key:"_getFetchUrl",value:function(e,t){return"".concat(this._platformServiceUrl,"/q?type=").concat(e,"&id=").concat(t)}},{key:"_createSecurityTokenError",value:function(e,t){var n="Failed to ".concat(e,". Security token is either expired or not exist.");return new I(401,[n],t)}}]),e}(),Re=function(e){function t(e,n,r,i,o){var s;return u()(this,t),(s=l()(this,h()(t).call(this)))._id=e,s._homeId=n,s._conversationsId=r,s._cloudEntityId=i,s._securityToken=o,s}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getHomeId",value:function(){return this._homeId}},{key:"getConversationsId",value:function(){return this._conversationsId}},{key:"getCloudEntityId",value:function(){return this._cloudEntityId}},{key:"getInitialSecurityToken",value:function(){return this._securityToken}},{key:"getInitialSecurityTokenString",value:function(){return this._securityToken.getToken()}},{key:"getInitialSecurityTokenExpiryTime",value:function(){return this._securityToken.getExpiryTime()}},{key:"getInitialSecurityTokenFormattedExpiryTime",value:function(){return this._securityToken.getFormattedExpiryTime()}},{key:"getLatestSecurityToken",value:function(){var e=this._getSecurityTokenService(),t=e.getCurrentStoredAccount(),n=t?t.getId():void 0;return this._id===n?e.getCurrentStoredSecurityToken():this._securityToken}},{key:"getLatestSecurityTokenString",value:function(){return this.getLatestSecurityToken().getToken()}},{key:"getLatestSecurityTokenExpiryTime",value:function(){return this.getLatestSecurityToken().getExpiryTime()}},{key:"getLatestFormattedSecurityTokenExpiryTime",value:function(){return this.getLatestSecurityToken().getFormattedExpiryTime()}},{key:"startConversation",value:function(e){return this._getConversationService().startConversation(e)}},{key:"startConversationWithRecognisedIntent",value:function(e){return this._getConversationService().startConversationWithRecognisedIntent(e)}},{key:"getConversation",value:function(e){return this._getConversationService().findOrFetchConversation(e)}},{key:"getConversations",value:function(){return this._getConversationsService().findOrFetchConversations(this._conversationsId)}},{key:"getCloudEntity",value:function(){return this._getCloudEntityService().findOrFetchCloudEntity(this._cloudEntityId)}},{key:"toObjectLiteral",value:function(){return{id:this._id,homeId:this._homeId,conversationsId:this._conversationsId,cloudEntityId:this._cloudEntityId,securityToken:this.getLatestSecurityToken().toObjectLiteral()}}},{key:"_getSecurityTokenService",value:function(){return vn.getSecurityTokenService()}},{key:"_getCloudEntityService",value:function(){return vn.getCloudEntityService()}},{key:"_getConversationService",value:function(){return vn.getConversationService()}},{key:"_getConversationsService",value:function(){return vn.getConversationsService()}}]),t}(y),Ue=function(e){function t(e,n,r){var i;return u()(this,t),(i=l()(this,h()(t).call(this)))._accountId=e,i._token=n,i._expiryTime=r,i}return v()(t,e),a()(t,[{key:"getAccountId",value:function(){return this._accountId}},{key:"getToken",value:function(){return this._token}},{key:"getExpiryTime",value:function(){return this._expiryTime}},{key:"isExpired",value:function(){return Y()>=this._expiryTime}},{key:"getFormattedExpiryTime",value:function(){return z(this._expiryTime)}},{key:"toObjectLiteral",value:function(){return{accountId:this._accountId,token:this._token,expiryTime:this._expiryTime,formattedExpiryTime:this.getFormattedExpiryTime()}}}]),t}(y);function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Pe=function(){function e(t,n){u()(this,e),this._accountDetailsStorage=t,this._securityTokenScheduler=n}return a()(e,[{key:"storeAccount",value:function(t,n){var r,o=(r={},i()(r,e.ACCOUNT_ID_KEY,t.getId()),i()(r,e.ACCOUNT_HOME_ID_KEY,t.getHomeId()),i()(r,e.ACCOUNT_CONVERSATIONS_ID_KEY,t.getConversationsId()),i()(r,e.ACCOUNT_CLOUD_ENTITY_ID_KEY,t.getCloudEntityId()),i()(r,e.ACCOUNT_SECURITY_TOKEN_KEY,n.getToken()),i()(r,e.ACCOUNT_SECURITY_TOKEN_EXPIRY_TIME_KEY,n.getExpiryTime()),r);return this._saveAccountDetails(o),this._scheduleSecurityTokenRefreshmentTask()}},{key:"startAccountSecurityTokenRefreshmentTask",value:function(){this.isCurrentAccountSecurityTokenValid()&&this._scheduleSecurityTokenRefreshmentTask()}},{key:"getCurrentStoredAccount",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e)){var t=this._getCurrentAccountId(e),n=this._getCurrentAccountHomeId(e),r=this._getCurrentAccountConversationsId(e),i=this._getCurrentAccountCloudEntityId(e),o=this._getCurrentAccountSecurityTokenString(e),u=this._getCurrentAccountSecurityTokenExpiryTime(e),s=new Ue(t,o,u);return new Re(t,n,r,i,s)}}},{key:"getCurrentStoredSecurityToken",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e)){var t=this._getCurrentAccountId(e),n=this._getCurrentAccountSecurityTokenString(e),r=this._getCurrentAccountSecurityTokenExpiryTime(e);return new Ue(t,n,r)}}},{key:"getCurrentStoredAccountId",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e))return this._getCurrentAccountId(e)}},{key:"getCurrentStoredAccountConversationsId",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e))return this._getCurrentAccountConversationsId(e)}},{key:"getCurrentStoredAccountCloudEntityId",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e))return this._getCurrentAccountCloudEntityId(e)}},{key:"clearCurrentStoredAccount",value:function(){this._accountDetailsStorage.deleteItem(e.SDK_ACCOUNT_KEY),this._securityTokenScheduler.clearScheduledRefreshmentTime()}},{key:"isCurrentAccountSecurityTokenValid",value:function(){var e=this._getCurrentAccountDetails();if(!b()(e)){var t=this._getCurrentAccountSecurityTokenExpiryTime(e);return Y()<t}return!1}},{key:"_scheduleSecurityTokenRefreshmentTask",value:function(){var e=this,t=this._getCurrentAccountDetails(),n=this._getCurrentAccountId(t),r=this._getCurrentAccountSecurityTokenString(t),i=this._getCurrentAccountSecurityTokenExpiryTime(t);return this._securityTokenScheduler.scheduleTokenRefreshment(n,r,i).then((function(t){return t&&e._saveNewSecurityToken(t),e._scheduleSecurityTokenRefreshmentTask()})).catch((function(e){le.logInfo(e.message)}))}},{key:"_saveNewSecurityToken",value:function(t){var n,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._getCurrentAccountDetails(),(n={},i()(n,e.ACCOUNT_SECURITY_TOKEN_KEY,t.getToken()),i()(n,e.ACCOUNT_SECURITY_TOKEN_EXPIRY_TIME_KEY,t.getExpiryTime()),n));this._saveAccountDetails(r)}},{key:"_saveAccountDetails",value:function(t){this._accountDetailsStorage.storeItem(e.SDK_ACCOUNT_KEY,JSON.stringify(t))}},{key:"_getCurrentAccountDetails",value:function(){var t=this._accountDetailsStorage.retrieveItem(e.SDK_ACCOUNT_KEY);return t?JSON.parse(t):{}}},{key:"_getCurrentAccountId",value:function(t){return t[e.ACCOUNT_ID_KEY]}},{key:"_getCurrentAccountHomeId",value:function(t){return t[e.ACCOUNT_HOME_ID_KEY]}},{key:"_getCurrentAccountConversationsId",value:function(t){return t[e.ACCOUNT_CONVERSATIONS_ID_KEY]}},{key:"_getCurrentAccountCloudEntityId",value:function(t){return t[e.ACCOUNT_CLOUD_ENTITY_ID_KEY]}},{key:"_getCurrentAccountSecurityTokenString",value:function(t){return t[e.ACCOUNT_SECURITY_TOKEN_KEY]}},{key:"_getCurrentAccountSecurityTokenExpiryTime",value:function(t){return t[e.ACCOUNT_SECURITY_TOKEN_EXPIRY_TIME_KEY]}}],[{key:"SDK_ACCOUNT_KEY",get:function(){return"mw.sdk.account"}},{key:"ACCOUNT_ID_KEY",get:function(){return"accountId"}},{key:"ACCOUNT_HOME_ID_KEY",get:function(){return"accountHomeId"}},{key:"ACCOUNT_CONVERSATIONS_ID_KEY",get:function(){return"accountConversationsId"}},{key:"ACCOUNT_CLOUD_ENTITY_ID_KEY",get:function(){return"accountCloudEntityId"}},{key:"ACCOUNT_SECURITY_TOKEN_KEY",get:function(){return"accountSecurityToken"}},{key:"ACCOUNT_SECURITY_TOKEN_EXPIRY_TIME_KEY",get:function(){return"accountSecurityTokenExpiryTime"}}]),e}(),Fe=function(){function e(t,n,r,i,o){u()(this,e),this._commandSubmissionService=t,this._securityTokenFactory=n,this._scheduledRefreshmentTimeStorage=r,this._securityTokenRefreshmentTimeCalculator=i,this._securityTokenRefreshedOffsetInMilliseconds=o}return a()(e,[{key:"scheduleTokenRefreshment",value:function(e,t,n){var r=this,i=this._calculateTargetRefreshmentTime(n),o=this._getCurrentScheduledRefreshmentTime(),u=this._securityTokenRefreshmentTimeCalculator.calculate(i,o),s=u.newScheduledTokenRefreshmentTime,a=u.delayInMilliseconds;return this._setCurrentScheduledRefreshmentTime(s),D(a).then((function(){var n=r._getCurrentScheduledRefreshmentTime();return n?n<=Y()?r._refreshToken(e,t):Promise.resolve():Promise.reject(new Error(r._getStopSchedulingMessage(e)))}))}},{key:"clearScheduledRefreshmentTime",value:function(){this._scheduledRefreshmentTimeStorage.deleteItem(e.TOKEN_SCHEDULED_REFRESHMENT_TIME_KEY)}},{key:"_refreshToken",value:function(e,t){var n=this;return this._commandSubmissionService.submitCommand({type:"refresh_token"},t).then((function(t){var r=n._securityTokenFactory.create(e,t),i=n._calculateTargetRefreshmentTime(r.getExpiryTime());return n._setCurrentScheduledRefreshmentTime(i),Promise.resolve(r)}))}},{key:"_calculateTargetRefreshmentTime",value:function(e){return e-this._securityTokenRefreshedOffsetInMilliseconds}},{key:"_setCurrentScheduledRefreshmentTime",value:function(t){this._scheduledRefreshmentTimeStorage.storeItem(e.TOKEN_SCHEDULED_REFRESHMENT_TIME_KEY,t.toString())}},{key:"_getCurrentScheduledRefreshmentTime",value:function(){var t=this._scheduledRefreshmentTimeStorage.retrieveItem(e.TOKEN_SCHEDULED_REFRESHMENT_TIME_KEY);return T(t)?parseInt(t):void 0}},{key:"_getStopSchedulingMessage",value:function(e){return"Security token for account id: ".concat(e," is stopped to refresh since the account has been removed")}}],[{key:"TOKEN_SCHEDULED_REFRESHMENT_TIME_KEY",get:function(){return"mw.sdk.token.scheduledRefreshmentTime"}}]),e}(),Me=function(){function e(){u()(this,e)}return a()(e,[{key:"calculate",value:function(e,t){var n=Y(),r=this._calculateAdjustedTokenRefreshmentTime(e,t,n);return{newScheduledTokenRefreshmentTime:r<n?n:r,delayInMilliseconds:this._calculateDelay(n,r)}}},{key:"_calculateAdjustedTokenRefreshmentTime",value:function(t,n,r){if(n&&n>r){var i=n-e.ADJUSTED_FACTOR;return i>r?i:n}return t}},{key:"_calculateDelay",value:function(e,t){var n=t-e;return n>0?n:0}}],[{key:"ADJUSTED_FACTOR",get:function(){return 1100}}]),e}(),Le=function(){function e(t,n,r,i,o){u()(this,e),this._commandSubmissionService=t,this._clientAuthenticationService=n,this._accountService=r,this._securityTokenService=i,this._securityTokenFactory=o}return a()(e,[{key:"signUp",value:function(e){var t=this,n=this._accountService.getCurrentStoredAccount();return n?this._doSignUp(n,n.getLatestSecurityTokenString(),e,!1):this._accountService.createAccount().then((function(n){return t._doSignUp(n,n.getLatestSecurityTokenString(),e,!0)}))}},{key:"_doSignUp",value:function(e,t,n,r){var i=this;return this._submitSignUp(e,t,n).then((function(e){var r=e.account,o=e.signUpSubmissionResponse;return o.success?i._followUpOnSignUp(r,t,o):i._failOnSignUp(n,o.errors)})).then((function(e){return i._storeAccountAndCreateUser(e)})).catch((function(e){return i._removeNewAccountIfFailOnSignUp(r),Promise.reject(e)}))}},{key:"_submitSignUp",value:function(e,t,n){return this._clientAuthenticationService.signUp(n,t).then((function(t){return Promise.resolve({account:e,signUpSubmissionResponse:t})}))}},{key:"_followUpOnSignUp",value:function(e,t,n){var r=n.profile,i=P(n.payload.links);return this._commandSubmissionService.followUpOnSubmittedCommand(i,t).then((function(t){return Promise.resolve({account:e,userProfile:r,signUpCompletionResponse:t})}))}},{key:"_failOnSignUp",value:function(e,t){var n=new I(403,t,this._clientAuthenticationService.getSignUpUrl(),e);return Promise.reject(n)}},{key:"_storeAccountAndCreateUser",value:function(e){var t=e.account,n=e.userProfile,r=e.signUpCompletionResponse,i=this._securityTokenFactory.create(t.getId(),r);return this._securityTokenService.storeAccount(t,i),new be(n,t)}},{key:"_removeNewAccountIfFailOnSignUp",value:function(e){e&&this._accountService.clearCurrentStoredAccount()}}]),e}(),Ne=function(e){function t(e){var n;return u()(this,t),(n=l()(this,h()(t).call(this)))._requestTimeOutInMilliseconds=e,n}return v()(t,e),a()(t,[{key:"calculateBackoffInterval",value:function(e){var n=e*e*t.RETRY_BACKOFF_FACTOR;return n>t.MAX_BACKOFF_IN_MILLISECONDS?t.MAX_BACKOFF_IN_MILLISECONDS:n}},{key:"shouldStopToFollowUp",value:function(e){return Y()>e}},{key:"onStopToFollowUp",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this._requestTimeOutInMilliseconds/t.SECOND_TO_MILLISECONDS,i="Entity is not ready after ".concat(r," seconds");return Promise.reject(new I(408,[i],e,n))}}],[{key:"SECOND_TO_MILLISECONDS",get:function(){return 1e3}},{key:"RETRY_BACKOFF_FACTOR",get:function(){return 25}},{key:"MAX_BACKOFF_IN_MILLISECONDS",get:function(){return 1e3}}]),t}(Q),xe=n(14),Ve=n.n(xe);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var He=function(){function e(t,n){u()(this,e),this._requestTimeOutInMilliseconds=t,Ve.a.defaults.timeout=n}return a()(e,[{key:"doPost",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this._calculateTimeOutTime(),u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,s=this._calculateBackoff(i);return this._reachTimeOut(o)?Promise.reject(this._createTimeOutError(e,u,t)):D(s).then((function(){return Ve.a.post(e,t,{headers:n}).catch((function(u){return r._isTimeOutError(u)?r.doPost(e,t,r._createRequestHeaders(n),i+1,o,u):Promise.reject(u)}))}))}},{key:"doGet",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._calculateTimeOutTime(),o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,u=this._calculateBackoff(r);return this._reachTimeOut(i)?Promise.reject(this._createTimeOutError(e,o)):D(u).then((function(){return Ve.a.get(e,{headers:t}).catch((function(o){return n._isTimeOutError(o)?n.doGet(e,n._createRequestHeaders(t),r+1,i,o):Promise.reject(o)}))}))}},{key:"_createRequestHeaders",value:function(e){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({"Content-Type":"application/json",Accept:"application/json"},e)}},{key:"_isTimeOutError",value:function(e){return"ECONNABORTED"===e.code}},{key:"_reachTimeOut",value:function(e){return Y()>e}},{key:"_calculateBackoff",value:function(t){var n=t*t*e.RETRY_BACKOFF_FACTOR;return n>e.MAX_BACKOFF_IN_MILLISECONDS?e.MAX_BACKOFF_IN_MILLISECONDS:n}},{key:"_calculateTimeOutTime",value:function(){return K(this._requestTimeOutInMilliseconds)}},{key:"_createTimeOutError",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this._requestTimeOutInMilliseconds/e.SECOND_TO_MILLISECONDS,o="Failed to submit request after ".concat(i," seconds");return new I(503,[o],t,r,n)}}],[{key:"RETRY_BACKOFF_FACTOR",get:function(){return 25}},{key:"MAX_BACKOFF_IN_MILLISECONDS",get:function(){return 1e3}},{key:"SECOND_TO_MILLISECONDS",get:function(){return 1e3}}]),e}(),Ye=function(){function e(t){u()(this,e),this._securityTokenFactory=t}return a()(e,[{key:"create",value:function(e,t){var n=t.links,r=F(n),i=M(n),o=t.payload.user_cloud_id,u=this._securityTokenFactory.create(e,t);return new Re(e,r,i,o,u)}}]),e}(),Be=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};u()(this,e),this._submitted=t,this._conversation=n,this._fieldValidationErrors=r}return a()(e,[{key:"isSubmitted",value:function(){return this._submitted}},{key:"getAnsweredConversation",value:function(){return this._conversation}},{key:"getFieldValidationErrors",value:function(){return this._fieldValidationErrors}}]),e}(),Ke=function(e){function t(e,n,r){var i;return u()(this,t),(i=l()(this,h()(t).call(this)))._id=e,i._intent=n,i._lastUpdatedTimestamp=r,i}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getIntent",value:function(){return this._intent}},{key:"getLastUpdatedTimestamp",value:function(){return this._lastUpdatedTimestamp}},{key:"getFormattedLastUpdatedTimestamp",value:function(){return z(this._lastUpdatedTimestamp)}},{key:"getConversation",value:function(){return this._getConversationService().findOrFetchConversation(this._id)}},{key:"toObjectLiteral",value:function(){return{id:this._id,intent:this._intent,lastUpdatedTimestamp:this._lastUpdatedTimestamp,formattedLastUpdatedTimestamp:this.getFormattedLastUpdatedTimestamp()}}},{key:"_getConversationService",value:function(){return vn.getConversationService()}}]),t}(y),We=function(e){function t(e,n,r,i,o,s,a){var c;return u()(this,t),(c=l()(this,h()(t).call(this)))._id=e,c._description=n,c._intent=r,c._canContinue=i,c._liveAgentStatus=o,c._lastUpdatedTimestamp=s,c._interactions=a,c}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getDescription",value:function(){return this._description}},{key:"getIntent",value:function(){return this._intent}},{key:"getLastUpdatedTimestamp",value:function(){return this._lastUpdatedTimestamp}},{key:"getInteractions",value:function(){return this._interactions}},{key:"addInteraction",value:function(e){this._interactions.push(e)}},{key:"getInteraction",value:function(e){return this._interactions.find((function(t){return t.getId()===e}))}},{key:"hasInteraction",value:function(e){return!!this.getInteraction(e)}},{key:"isInteractionCompleted",value:function(e){var t=this.getInteraction(e);return t&&t.isResponded()||!this.canContinue()}},{key:"getCurrentInteraction",value:function(){return this._interactions[this._interactions.length-1]}},{key:"canContinue",value:function(){return this._canContinue}},{key:"isConnectingToLiveAgent",value:function(){return this._liveAgentStatus===t.CALLING_LIVE_AGENT_STATUS||this._liveAgentStatus===t.WAITING_FOR_CONNECTION_FROM_LIVE_AGENT_STATUS||this._liveAgentStatus===t.TALKING_TO_LIVE_AGENT_STATUS}},{key:"connectToLiveAgent",value:function(){return this._getConversationService().connectToLiveAgent(this._id).then((function(e){return Promise.resolve(e)}))}},{key:"disconnectFromLiveAgent",value:function(){return this._getConversationService().disconnectFromLiveAgent(this._id).then((function(e){return Promise.resolve(e)}))}},{key:"submitAnswers",value:function(){var e=this.getCurrentInteraction(),t=e.validateFieldsAnswers();if(b()(t)){var n=e.getAnswers();return this.isConnectingToLiveAgent()?this._getConversationService().answerLiveAgent(this,e.getId(),n).then((function(e){return Promise.resolve(new Be(!0,e))})):this._getConversationService().answerInteraction(this._id,e.getId(),n).then((function(e){return Promise.resolve(new Be(!0,e))}))}return Promise.resolve(new Be(!1,this,t))}},{key:"reload",value:function(e){var t=this;this._canContinue=e._canContinue,this._liveAgentStatus=e._liveAgentStatus,this._lastUpdatedTimestamp=e.getLastUpdatedTimestamp();var n=this.getCurrentInteraction(),r=this._interactions.findIndex((function(e){return e.getId()===n.getId()})),i=e.getInteractions();return i.slice(r,i.length).forEach((function(e){e.getId()===n.getId()?n.reload(e):t.addInteraction(e)})),this}},{key:"refresh",value:function(){var e=this,t=this._interactions.reduce((function(e,t){return e.push(t.refresh()),e}),[]);return Promise.all(t).then((function(t){return Promise.resolve(e)}))}},{key:"toObjectLiteral",value:function(){return{id:this._id,description:this._description,intent:this._intent,canContinue:this.canContinue(),liveAgentStatus:this._liveAgentStatus,lastUpdatedTimestamp:this._lastUpdatedTimestamp,interactions:this._interactions.map((function(e){return e.toObjectLiteral()}))}}},{key:"getSummary",value:function(){return new Ke(this._id,this._intent,this._lastUpdatedTimestamp)}},{key:"_getConversationService",value:function(){return vn.getConversationService()}}],[{key:"CALLING_LIVE_AGENT_STATUS",get:function(){return"Calling"}},{key:"WAITING_FOR_CONNECTION_FROM_LIVE_AGENT_STATUS",get:function(){return"Waiting for connection"}},{key:"TALKING_TO_LIVE_AGENT_STATUS",get:function(){return"Talking"}}]),t}(_),Ge=function(){function e(t){u()(this,e),this._interactionFactory=t}return a()(e,[{key:"create",value:function(e){var t=e.payload,n=t.id,r=t.description,i=t.intent,o=t.can_continue,u=t.live_agent_status,s=t.updated_at,a=this._createInteractions(t.interactions);return new We(n,r,i,o,u,s,a)}},{key:"_createInteractions",value:function(e){var t=this;return e.map((function(e){return t._interactionFactory.create(e)}))}}]),e}(),Xe=function(e){function t(e){var n;return u()(this,t),(n=l()(this,h()(t).call(this)))._id=e,n._conversationSummaries=[],n}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getConversationSummaries",value:function(){return this._conversationSummaries}},{key:"addConversationSummary",value:function(e){this._conversationSummaries.push(e)}},{key:"getConversationSummary",value:function(e){return this._conversationSummaries.find((function(t){return t.getId()===e}))}},{key:"reload",value:function(e){var t=this;return e.getConversationSummaries().forEach((function(e){t.getConversationSummary(e.getId())||t.addConversationSummary(e)})),this}},{key:"toObjectLiteral",value:function(){return{conversationsId:this._id,conversationSummaries:this._conversationSummaries.map((function(e){return e.toObjectLiteral()}))}}}]),t}(_),$e=function(){function e(){u()(this,e)}return a()(e,[{key:"create",value:function(e){var t=e.id,n=e.payload.conversations,r=new Xe(t),i=!0,o=!1,u=void 0;try{for(var s,a=n[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var c=s.value;r.addConversationSummary(this._createConversationSummary(c))}}catch(e){o=!0,u=e}finally{try{i||null==a.return||a.return()}finally{if(o)throw u}}return r}},{key:"_createConversationSummary",value:function(e){var t=e.conversation_id,n=e.intent,r=e.last_updated_at;return new Ke(t,n,r)}}]),e}();function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Ze=function(e){function t(){var e;return u()(this,t),(e=l()(this,h()(t).call(this)))._conversationMap=new Map,e}return v()(t,e),a()(t,[{key:"cacheConversations",value:function(e){return this._conversations?this._conversations.reload(e):this._conversations=e,this._conversations}},{key:"cacheConversation",value:function(e){var t=e.getId(),n=this._conversationMap.get(t);(n?n.reload(e):(this._conversationMap.set(t,e),n=e),this._conversations)&&(this._conversations.getConversationSummary(t)||this._conversations.addConversationSummary(n.getSummary()));return n}},{key:"lookupConversation",value:function(e){return this._conversationMap.get(e)}},{key:"getConversations",value:function(){return this._conversations}},{key:"clear",value:function(){this._conversations=null,this._conversationMap.clear()}},{key:"toObjectLiteral",value:function(){var e=this,t={};if(this._conversations&&(t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this._conversations.toObjectLiteral())),this._conversationMap.size>0){var n=oe()(this._conversationMap.keys()).reduce((function(t,n){return t[n]=e._conversationMap.get(n).toObjectLiteral(),t}),{});t.conversations=n}return t}}]),t}(y),Je=Object.freeze({CONFIRM_DETAILS:"confirmDetails",RELATED_ENTITIES:"relatedEntities",STANDARD:"standard"}),Qe=function(e){function t(e,n,r,i,o){var s,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],c=arguments.length>6?arguments[6]:void 0,f=arguments.length>7?arguments[7]:void 0;return u()(this,t),(s=l()(this,h()(t).call(this)))._id=e,s._name=n,s._type=r,s._prompt=i,s._requireUserIdentified=o,s._fields=a,s._errorMessages=c,s._userResponse=f,s}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getName",value:function(){return this._name}},{key:"getType",value:function(){return this._type}},{key:"getPrompt",value:function(){return this._prompt}},{key:"getUserResponse",value:function(){return this._userResponse}},{key:"isUserIdentifiedRequired",value:function(){return this._requireUserIdentified}},{key:"isResponded",value:function(){return T(this.getUserResponse())}},{key:"getFields",value:function(){return this._fields}},{key:"getField",value:function(e){return this._fields.find((function(t){return t.getId()===e}))}},{key:"getErrorMessages",value:function(){return this._errorMessages}},{key:"getAnswers",value:function(){return this._fields.reduce((function(e,t){return e[t.getId()]=t.getSubmittedAnswer(),e}),{})}},{key:"validateFieldsAnswers",value:function(){return this._fields.reduce((function(e,t){var n=t.validate();n.isValid()||(e[t.getId()]=n.getErrorMessage());return e}),{})}},{key:"reload",value:function(e){return this._userResponse=e.getUserResponse(),this._fields.forEach((function(t){var n=t.getId(),r=e.getField(n);t.reload(r)})),this}},{key:"refresh",value:function(){var e=this,t=this._fields.reduce((function(e,t){return e.push(t.refresh()),e}),[]);return Promise.all(t).then((function(t){return Promise.resolve(e)}))}},{key:"toObjectLiteral",value:function(){var e=this._fields.reduce((function(e,t){return e.push(t.toObjectLiteral()),e}),[]),t=this.getAnswers(),n=Object.keys(t).reduce((function(e,n){var r=t[n],i=r instanceof y?r.toObjectLiteral():r;return e[n]=i,e}),{});return{id:this._id,name:this._name,type:this._type,prompt:this._prompt,requireUserIdentified:this._requireUserIdentified,userResponse:this._userResponse,fields:e,errorMessages:this._errorMessages,answers:n}}}]),t}(y),et=function(){function e(t){u()(this,e),this._fieldFactoryRegistry=t}return a()(e,[{key:"create",value:function(e){var t=e.id,n=e.name,r=e.type,i=e.prompt,o=e.requireUserIdentified,u=e.answer||{},s=e.user_response,a=this._createInteractionFields(r,e.data,u),c=e.errorMessages;return new Qe(t,n,r,i,o,a,c,s)}},{key:"_createInteractionFields",value:function(e,t,n){return Je.RELATED_ENTITIES===e?this._createFields(t,me.MULTIPLE_CHOICES_WITH_OTHER_FIELD,n):Je.CONFIRM_DETAILS===e?this._createFields(t,me.CONFIRM_DETAILS_FIELD,n):this._createFields(t,"",n)}},{key:"_createFields",value:function(e,t,n){var r=this;return Object.keys(e).reduce((function(i,o){var u=n[o],s=e[o],a=T(t)?t:s.type,c=r._fieldFactoryRegistry.lookupInteractionFieldFactory(a);return i.push(c.create(s,u)),i}),[])}}]),e}(),tt=function(e){function t(e,n,r){var i;u()(this,t);var o=(i=l()(this,h()(t).call(this)))._parseDate(e,n,r);return i._year=o.getFullYear(),i._month=o.getMonth(),i._dayOfMonth=o.getDate(),i}return v()(t,e),a()(t,[{key:"getYear",value:function(){return this._year}},{key:"getMonth",value:function(){return this._month}},{key:"getDayOfMonth",value:function(){return this._dayOfMonth}},{key:"toIsoZonedDateTimeString",value:function(){return $(this._year,this._month,this._dayOfMonth)}},{key:"toEpochMilliseconds",value:function(){return X(this._year,this._month,this._dayOfMonth)}},{key:"isBefore",value:function(e){return this.toEpochMilliseconds()<e.toEpochMilliseconds()}},{key:"isAfter",value:function(e){return this.toEpochMilliseconds()>e.toEpochMilliseconds()}},{key:"toObjectLiteral",value:function(){return{year:this._year,month:this._month,dayOfMonth:this._dayOfMonth}}},{key:"_parseDate",value:function(e,t,n){return G(e,t,n)}}]),t}(y);function nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var rt=function(e){function t(e,n,r,i,o,s){var a;u()(this,t);var c=(a=l()(this,h()(t).call(this,e,n,r)))._parseDate(e,n,r,i,o,s);return a._hour=c.getHours(),a._minute=c.getMinutes(),a._second=c.getSeconds(),a}return v()(t,e),a()(t,[{key:"getHour",value:function(){return this._hour}},{key:"getMinute",value:function(){return this._minute}},{key:"getSecond",value:function(){return this._second}},{key:"toIsoZonedDateTimeString",value:function(){return $(this._year,this._month,this._dayOfMonth,this._hour,this._minute,this._second)}},{key:"toEpochMilliseconds",value:function(){return X(this._year,this._month,this._dayOfMonth,this._hour,this._minute,this._second)}},{key:"isBefore",value:function(e){return this.toEpochMilliseconds()<e.toEpochMilliseconds()}},{key:"isAfter",value:function(e){return this.toEpochMilliseconds()>e.toEpochMilliseconds()}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{hour:this._hour,minute:this._minute,second:this._second})}},{key:"_parseDate",value:function(e,t,n,r,i,o){return G(e,t,n,r,i,o)}}]),t}(tt),it=function(){function e(){u()(this,e)}return a()(e,[{key:"create",value:function(e,t){var n=this._convertToLocalDate(e.substring(0,e.indexOf("[")));return t?new rt(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds()):new tt(n.getFullYear(),n.getMonth(),n.getDate())}},{key:"_convertToLocalDate",value:function(e){return function(e){return H()(e)}(e)}}]),e}(),ot=function(){function e(t){u()(this,e),this._answerValidatorFactory=t}return a()(e,[{key:"extractCommonAttributes",value:function(e){return{id:e.id,hint:e.hint,description:e.description,errorMessages:e.errorMessages,required:e.required}}}]),e}();function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var st=function(e){function t(e,n,r,i,o,s,a,c){var f;return u()(this,t),(f=l()(this,h()(t).call(this,e,n,r,me.CONFIRM_DETAILS_FIELD,i,o,a,c)))._label=s,f}return v()(t,e),a()(t,[{key:"getLabel",value:function(){return this._label}},{key:"confirm",value:function(e){return this._answer=e,pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),label:this._label})}}]),t}(ge),at=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.value,l=this._answerValidatorFactory.createBooleanAnswerValidator(a);return new st(i,o,u,s,a,c,n,l)}}]),t}(ot);function ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var lt=function(e){function t(e,n,r,i,o,s,a){return u()(this,t),l()(this,h()(t).call(this,e,n,r,me.CONFIRMATION_FIELD,i,o,s,a))}return v()(t,e),a()(t,[{key:"confirm",value:function(e){return this._answer=e,pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ct(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer()})}}]),t}(ge),ft=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=this._answerValidatorFactory.createBooleanAnswerValidator(a);return new lt(i,o,u,s,a,n,c)}}]),t}(ot);function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var dt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.CURRENCY_FIELD,i,o,d,v)))._defaultValue=s,y._fractionalDigits=a,y._minValue=c,y._maxValue=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getFractionalDigits",value:function(){return this._fractionalDigits}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"enter",value:function(e){return this._answer=e,pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,fractionalDigits:this._fractionalDigits,minValue:this._minValue,maxValue:this._maxValue})}}]),t}(ge),vt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.fractionalDigits,f=e.min,d=e.max,v=this._answerValidatorFactory.createNumberAnswerValidator(a,f,d);return new dt(i,o,u,s,a,c,l,f,d,n,v)}}]),t}(ot);function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var _t=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.DATE_FIELD,i,o,d,v)))._defaultValue=s,y._minDate=a,y._maxDate=c,y._validationMessage=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getMinDate",value:function(){return this._minDate}},{key:"getMaxDate",value:function(){return this._maxDate}},{key:"getValidationMessage",value:function(){return this._validationMessage}},{key:"enter",value:function(e){return this._answer=e,pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._convertToIsoZonedFormat(this._answer)}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{answer:this._convertDateToObjectLiteral(this._answer),submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._convertDateToObjectLiteral(this._defaultValue),defaultValueInIsoZonedFormat:this._convertToIsoZonedFormat(this._defaultValue),minDate:this._convertDateToObjectLiteral(this._minDate),minDateInIsoZonedFormat:this._convertToIsoZonedFormat(this._minDate),maxDate:this._convertDateToObjectLiteral(this._maxDate),maxDateInIsoZonedFormat:this._convertToIsoZonedFormat(this._maxDate),validationMessage:this._validationMessage})}},{key:"_convertDateToObjectLiteral",value:function(e){return e?e.toObjectLiteral():e}},{key:"_convertToIsoZonedFormat",value:function(e){return e?e.toIsoZonedDateTimeString():e}}]),t}(ge),pt=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this,n)))._dateTimeFactory=e,r}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.includeTime,l=this._createDateTime(e.defaultValue,c),f=this._createDateTime(e.min,c),d=this._createDateTime(e.max,c),v=e.validationMessage,y=this._createDateTime(n,c),_=this._answerValidatorFactory.createDateAnswerValidator(a,f,d,v);return new _t(i,o,u,s,a,l,f,d,v,y,_)}},{key:"_createDateTime",value:function(e,t){return T(e)?this._dateTimeFactory.create(e,t):void 0}}]),t}(ot);function gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var mt=function(e){function t(e,n,r,i,o,s,a,c,f,d){var v;return u()(this,t),(v=l()(this,h()(t).call(this,e,n,r,me.EMAIL_FIELD,i,o,f,d)))._defaultValue=s,v._restriction=a,v._validationMessage=c,v}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getRestriction",value:function(){return this._restriction}},{key:"getValidationMessage",value:function(){return this._validationMessage}},{key:"enter",value:function(e){return this._answer=E(e),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,restriction:this._restriction,validationMessage:this._validationMessage})}}]),t}(ge),kt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.restriction,f=e.validationMessage,d=this._createAnswerValidator(a,l,f);return new mt(i,o,u,s,a,c,l,f,n,d)}},{key:"_createAnswerValidator",value:function(e,t,n){return T(t)?this._answerValidatorFactory.createRegexAnswerValidator(e,t,n):this._answerValidatorFactory.createMandatoryAnswerValidator(e)}}]),t}(ot),St=function(){function e(t,n){u()(this,e),this._valid=t,this._errorMessageIfInvalid=n}return a()(e,[{key:"isValid",value:function(){return this._valid}},{key:"getErrorMessage",value:function(){return this._valid?"":this._errorMessageIfInvalid}}],[{key:"ALWAYS_PASS_VALIDATION_RESULT",get:function(){return new e(!0,"")}}]),e}();function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var bt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.MULTI_SELECT_CHOICES_FIELD,i,o,d,v)))._defaultValue=s,y._labelKey=a,y._labels=c,y._choices=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getChoices",value:function(){return this._labels}},{key:"select",value:function(e){var n=E(e);if(this._answer.includes(n))return St.ALWAYS_PASS_VALIDATION_RESULT;this._answer.push(n);var r=pe()(h()(t.prototype),"validate",this).call(this);return r.isValid()||(this._answer=this._remove(n)),r}},{key:"selectAll",value:function(){return this._clearAnswer(),this._answer=this._answer.concat(this.getChoices()),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"deselect",value:function(e){var n=E(e);return this._answer=this._remove(n),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"deselectAll",value:function(){return this._clearAnswer(),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"_clearAnswer",value:function(){this._answer.splice(0,this._answer.length)}},{key:"_remove",value:function(e){return this._answer.filter((function(t){return t!==e}))}},{key:"getSubmittedAnswer",value:function(){var e=this;return this._choices.filter((function(t){return e._answer.includes(t[e._labelKey])}))}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,labelKey:this._labelKey,labels:this._labels,choices:this._choices})}}]),t}(ge),Et=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.labelKey,l=e.defaultValue,f=l?this._getLabels(l,c):[],d=n?this._getLabels(n,c):[],v=e.options,y=v.map((function(e){return e[c]})),_=this._answerValidatorFactory.createMultiSelectChoicesAnswerValidator(a,y);return new bt(i,o,u,s,a,f,c,y,v,d,_)}},{key:"_getLabels",value:function(e,t){return e.map((function(e){return e[t]}))}}]),t}(ot);function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Tt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v,y,_,p,g){var m;return u()(this,t),(m=l()(this,h()(t).call(this,e,n,r,me.MULTI_SELECT_CHOICES_WITH_RICH_CONTENT_FIELD,i,o,d,v)))._defaultValue=s,m._contentType=a,m._choices=c,m._emptyOptionsMessage=f,m._selectedChoices=d,m._fetchType=y,m._fetchUrl=_,m._isFetchSucceeded=p,m._fetchErrorMessage=g,m}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getContentType",value:function(){return this._contentType}},{key:"getRichContentChoices",value:function(){var e=this;return this._fetchChoices().then((function(t){return Promise.resolve(e._choices)}))}},{key:"getEmptyOptionsMessage",value:function(){return this._emptyOptionsMessage}},{key:"isFetchSucceeded",value:function(){return this._isFetchSucceeded}},{key:"getFetchErrorMessage",value:function(){return this._fetchErrorMessage}},{key:"select",value:function(e){if(this._answer.includes(e))return St.ALWAYS_PASS_VALIDATION_RESULT;this._answer.push(e);var n=pe()(h()(t.prototype),"validate",this).call(this);return n.isValid()?this._selectedChoices.push(this._choices[e]):this._answer=this._remove(e),n}},{key:"selectAll",value:function(){return this._clearAnswer(),this._answer=this._answer.concat(oe()(Array(this._choices.length).keys())),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"deselect",value:function(e){return this._answer=this._remove(e),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"deselectAll",value:function(){return this._clearAnswer(),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._selectedChoices}},{key:"refresh",value:function(){return this._fetchChoices()}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{answer:this.getSubmittedAnswer(),submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,contentType:this._contentType,choices:this._choices,emptyOptionsMessage:this._emptyOptionsMessage,fetchType:this._fetchType,fetchUrl:this._fetchUrl,fetchSucceeded:this._isFetchSucceeded,fetchErrorMessage:this._fetchErrorMessage})}},{key:"_fetchChoices",value:function(){var e=this;return this._isFetchFailed()?this._getFetchRichContentService().fetch(this._fetchUrl).then((function(t){return e._updateWithFetchResult(t),Promise.resolve(e)})):Promise.resolve(this)}},{key:"_isFetchFailed",value:function(){return this._fetchType===t.FETCH_FROM_URL_TYPE&&!this._isFetchSucceeded}},{key:"_updateWithFetchResult",value:function(e){if(e.succeeded){var t=e.richContentData;this._choices.splice(0,this._choices.length),this._choices=this._choices.concat(t),this._answerValidator.updateNumberOfChoices(t.length)}this._isFetchSucceeded=e.succeeded,this._fetchErrorMessage=e.errorMessage}},{key:"_getFetchRichContentService",value:function(){return vn.getFetchRichContentService()}},{key:"_clearAnswer",value:function(){this._answer.splice(0,this._answer.length)}},{key:"_remove",value:function(e){return this._answer.filter((function(t){return t!==e}))}}],[{key:"FETCH_FROM_URL_TYPE",get:function(){return"fetchFromUrl"}}]),t}(ge),wt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.optionType,f=e.options,d=f.data,v=f.emptyOptionsMessage,y=f.type,_=f.url,p=f.fetchSucceeded,g=f.fetchErrorMessage,m=this._answerValidatorFactory.createMultiSelectChoicesRichContentAnswerValidator(a,d.length);return new Tt(i,o,u,s,a,c,l,d,v,n,m,y,_,p,g)}}]),t}(ot);function It(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var At=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.MULTIPLE_CHOICES_FIELD,i,o,d,v)))._defaultValue=s,y._labelKey=a,y._labels=c,y._choices=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getChoices",value:function(){return this._labels}},{key:"choose",value:function(e){return this._answer=E(e),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){var e=this;return T(this._answer)?this._choices.find((function(t){return t[e._labelKey]===e._answer})):this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?It(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):It(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,labelKey:this._labelKey,labels:this._labels,choices:this._choices})}}]),t}(ge),jt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.labelKey,l=e.options,f=e.defaultValue,d=this._getMatchedChoiceLabel(l,c,f),v=l.map((function(e){return e[c]})),y=this._getMatchedChoiceLabel(l,c,n),_=this._answerValidatorFactory.createMultipleChoicesAnswerValidator(a,v);return new At(i,o,u,s,a,d,c,v,l,y,_)}},{key:"_getMatchedChoiceLabel",value:function(e,t,n){if(n){var r=e.find((function(e){return e[t]===n[t]}));return r?r[t]:void 0}return n}}]),t}(ot);function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ut(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Dt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v,y,_,p){var g;return u()(this,t),(g=l()(this,h()(t).call(this,e,n,r,me.MULTIPLE_CHOICES_WITH_OTHER_FIELD,i,o,y,p)))._defaultValue=s,g._labelKey=a,g._otherOptionValueKey=c,g._labels=f,g._choices=d,g._otherOptionTemplate=v,g._multipleChoicesAnswerValidator=_,g}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getChoices",value:function(){return this._labels}},{key:"getOtherOptionLabel",value:function(){return this._otherOptionTemplate[this._labelKey]}},{key:"choose",value:function(e){this._answer=E(e);var t=this._multipleChoicesAnswerValidator.validate(this._answer);return t.isValid()||(this._answer=void 0),t}},{key:"enterOther",value:function(e){return this._answer=E(e),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){var e=this;if(T(this._answer)){var t=this._choices.find((function(t){return t[e._labelKey]===e._answer}));return t||this._getSubmittedAnswerBasedOnOtherOptionTemplate()}return this._answer}},{key:"toObjectLiteral",value:function(){return Ut({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,labelKey:this._labelKey,otherOptionValueKey:this._otherOptionValueKey,otherOptionLabel:this.getOtherOptionLabel(),labels:this._labels,choices:this._choices,otherOptionTemplate:this._otherOptionTemplate})}},{key:"_getSubmittedAnswerBasedOnOtherOptionTemplate",value:function(){return Ut({},this._otherOptionTemplate,i()({},this._otherOptionValueKey,this._answer))}}]),t}(ge),Pt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.labelKey,l=e.options,f=l.map((function(e){return e[c]})),d=e.defaultValue,v=this._getMatchedChoiceLabel(l,c,d),y=this._getMatchedChoiceLabel(l,c,n),_=e.otherValueKey,p=e.otherOptionTemplate,g=this._answerValidatorFactory.createMultipleChoicesAnswerValidator(a,f),m=this._answerValidatorFactory.createMandatoryAnswerValidator(a);return new Dt(i,o,u,s,a,v,c,_,f,l,p,y,g,m)}},{key:"_getMatchedChoiceLabel",value:function(e,t,n){if(n){var r="PERSON"===n.type?this._findMatchedChoiceById(e,n):this._findMatchedChoiceByLabel(e,t,n);return r?r[t]:n[t]}return n}},{key:"_findMatchedChoiceById",value:function(e,t){return e.find((function(e){return e.id===t.id}))}},{key:"_findMatchedChoiceByLabel",value:function(e,t,n){return e.find((function(e){return e[t]===n[t]}))}}]),t}(ot),Ft=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.optionType,f=e.options,d=f.data,v=f.emptyOptionsMessage,y=f.type,_=f.url,p=f.fetchSucceeded,g=f.fetchErrorMessage,m=this._answerValidatorFactory.createMultipleChoicesRichContentAnswerValidator(a,d.length);return new Se(i,o,u,s,a,c,l,d,v,n,m,y,_,p,g)}}]),t}(ot);function Mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Lt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.NUMBER_FIELD,i,o,d,v)))._defaultValue=s,y._fractionalDigits=a,y._minValue=c,y._maxValue=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getFractionalDigits",value:function(){return this._fractionalDigits}},{key:"getMinValue",value:function(){return this._minValue}},{key:"getMaxValue",value:function(){return this._maxValue}},{key:"enter",value:function(e){return this._answer=e,pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,fractionalDigits:this._fractionalDigits,minValue:this._minValue,maxValue:this._maxValue})}}]),t}(ge),Nt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.fractionalDigits,f=e.min,d=e.max,v=this._answerValidatorFactory.createNumberAnswerValidator(a,f,d);return new Lt(i,o,u,s,a,c,l,f,d,n,v)}}]),t}(ot);function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Vt=function(e){function t(e,n,r,i,o,s,a){var c;return u()(this,t),(c=l()(this,h()(t).call(this,e,n,r,me.START_NEW_CONVERSATION_WITH_INTENT_FIELD,i,o,void 0,a)))._recognisedIntentPayload=s,c}return v()(t,e),a()(t,[{key:"getRecognisedIntentPayload",value:function(){return this._recognisedIntentPayload}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{recognisedIntentPayload:this._recognisedIntentPayload})}}]),t}(ge),qt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e){var n=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),r=n.id,i=n.hint,o=n.description,u=n.errorMessages,s=n.required,a=e.payload,c=this._answerValidatorFactory.createAlwaysPassAnswerValidator();return new Vt(r,i,o,u,s,a,c)}}]),t}(ot);function Ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var Yt=function(e){function t(e,n,r,i,o,s,a,c,f,d,v){var y;return u()(this,t),(y=l()(this,h()(t).call(this,e,n,r,me.TEXT_FIELD,i,o,d,v)))._defaultValue=s,y._restriction=a,y._validationMessage=c,y._allowMultipleLines=f,y}return v()(t,e),a()(t,[{key:"getDefaultValue",value:function(){return this._defaultValue}},{key:"getRestriction",value:function(){return this._restriction}},{key:"getValidationMessage",value:function(){return this._validationMessage}},{key:"isAllowMultipleLines",value:function(){return this._allowMultipleLines}},{key:"enter",value:function(e){return this._answer=E(e),pe()(h()(t.prototype),"validate",this).call(this)}},{key:"getSubmittedAnswer",value:function(){return this._answer}},{key:"toObjectLiteral",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ht(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},pe()(h()(t.prototype),"toObjectLiteral",this).call(this),{submittedAnswer:this.getSubmittedAnswer(),defaultValue:this._defaultValue,restriction:this._restriction,validationMessage:this._validationMessage,allowMultipleLines:this._allowMultipleLines})}}]),t}(ge),Bt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"create",value:function(e,n){var r=pe()(h()(t.prototype),"extractCommonAttributes",this).call(this,e),i=r.id,o=r.hint,u=r.description,s=r.errorMessages,a=r.required,c=e.defaultValue,l=e.restriction,f=e.validationMessage,d=e.allowMultipleLines,v=this._createAnswerValidator(a,l,f);return new Yt(i,o,u,s,a,c,l,f,d,n,v)}},{key:"_createAnswerValidator",value:function(e,t,n){return T(t)?this._answerValidatorFactory.createRegexAnswerValidator(e,t,n):this._answerValidatorFactory.createMandatoryAnswerValidator(e)}}]),t}(ot),Kt=function(){function e(t,n){u()(this,e),this._fieldFactories={},this._registerBuildInFieldFactories(t,n)}return a()(e,[{key:"register",value:function(e,t){this._throwErrorUnlessFieldTypeIsUnique(e),this._throwErrorUnlessFieldFactoryIsAnInstanceOfFieldFactory(e,t),this._fieldFactories[e]=t}},{key:"lookupInteractionFieldFactory",value:function(e){return this._fieldFactories[e]}},{key:"_registerBuildInFieldFactories",value:function(e,t){this.register(me.CONFIRM_DETAILS_FIELD,new at(t)),this.register(me.CONFIRMATION_FIELD,new ft(t)),this.register(me.CURRENCY_FIELD,new vt(t)),this.register(me.DATE_FIELD,new pt(e,t)),this.register(me.EMAIL_FIELD,new kt(t)),this.register(me.MULTI_SELECT_CHOICES_FIELD,new Et(t)),this.register(me.MULTI_SELECT_CHOICES_WITH_RICH_CONTENT_FIELD,new wt(t)),this.register(me.MULTIPLE_CHOICES_FIELD,new jt(t)),this.register(me.MULTIPLE_CHOICES_WITH_OTHER_FIELD,new Pt(t)),this.register(me.MULTIPLE_CHOICES_WITH_RICH_CONTENT_FIELD,new Ft(t)),this.register(me.NUMBER_FIELD,new Nt(t)),this.register(me.START_NEW_CONVERSATION_WITH_INTENT_FIELD,new qt(t)),this.register(me.TEXT_FIELD,new Bt(t))}},{key:"_throwErrorUnlessFieldTypeIsUnique",value:function(e){if(!this._isFieldTypeUnique(e))throw new Error("Field type '".concat(e,"' has been registered"))}},{key:"_throwErrorUnlessFieldFactoryIsAnInstanceOfFieldFactory",value:function(e,t){if(!(t instanceof ot))throw new Error("Field factory to be registered for field type '".concat(e,"' is not an instance of FieldFactory"))}},{key:"_isFieldTypeUnique",value:function(e){return!Object.keys(this._fieldFactories).includes(e)}}]),e}(),Wt=function(){function e(){u()(this,e)}return a()(e,[{key:"validate",value:function(e){throw new Error("Validator must implement validate(answer) method that returns a ValidationResult")}}]),e}(),Gt=function(e){function t(){return u()(this,t),l()(this,h()(t).apply(this,arguments))}return v()(t,e),a()(t,[{key:"validate",value:function(){return St.ALWAYS_PASS_VALIDATION_RESULT}}]),t}(Wt),Xt=function(e){function t(e){var n;return u()(this,t),(n=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,n}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=this._isNotPresent(e)||this._isBoolean(e);return new St(n,"Invalid value for boolean")}return t}},{key:"_isBoolean",value:function(e){return"boolean"==typeof e}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),$t=function(e){function t(e,n,r,i){var o;return u()(this,t),(o=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,o._minDate=n,o._maxDate=r,o._errorMessage=i,o}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=T(this._errorMessage)?this._errorMessage:"Date outside of range",r=this._isNotPresent(e)||this._isDate(e)&&this._meetMinDateRequirement(e)&&this._meetMaxDateRequirement(e);return new St(r,n)}return t}},{key:"_isDate",value:function(e){return e instanceof tt}},{key:"_meetMinDateRequirement",value:function(e){return this._isNotPresent(this._minDate)||e.isAfter(this._minDate)}},{key:"_meetMaxDateRequirement",value:function(e){return this._isNotPresent(this._maxDate)||e.isBefore(this._maxDate)}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),zt=function(e){function t(e){var n;return u()(this,t),(n=l()(this,h()(t).call(this)))._required=e,n}return v()(t,e),a()(t,[{key:"validate",value:function(e){return new St(!this._required||this.isPresent(e),"Answer is required")}},{key:"isPresent",value:function(e){return"boolean"==typeof e||"number"==typeof e||e instanceof tt||!b()(e)}}]),t}(Wt),Zt=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,r._choices=n,r}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=this._isNotPresent(e)||this._isAnArray(e)&&this._containAllChoices(e);return new St(n,"Invalid selected option")}return t}},{key:"_containAllChoices",value:function(e){var t=this;return!b()(e)&&e.every((function(e){return t._choices.includes(e)}))}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}},{key:"_isAnArray",value:function(e){return Array.isArray(e)}}]),t}(Wt),Jt=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,r._choices=n,r}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=C(e),r=this._isNotPresent(n)||this._isOneOfChoices(n);return new St(r,"Invalid option")}return t}},{key:"_isOneOfChoices",value:function(e){return this._choices.includes(e)}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),Qt=function(e){function t(e,n,r){var i;return u()(this,t),(i=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,i._minValue=n,i._maxValue=r,i}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=this._isNotPresent(e)||this._isNumber(e)&&this._meetMinValueRequirement(e)&&this._meetMaxValueRequirement(e);return new St(n,"Number outside of range")}return t}},{key:"_isNumber",value:function(e){return"number"==typeof e&&!isNaN(e)}},{key:"_meetMinValueRequirement",value:function(e){return this._isNotPresent(this._minValue)||e>=this._minValue}},{key:"_meetMaxValueRequirement",value:function(e){return this._isNotPresent(this._maxValue)||e<=this._maxValue}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),en=function(e){function t(e,n,r){var i;return u()(this,t),(i=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,i._regex=new RegExp(n),i._errorMessage=r,i}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=C(e),r=T(this._errorMessage)?this._errorMessage:"Invalid value",i=this._isNotPresent(n)||this._matchWithRegex(n);return new St(i,r)}return t}},{key:"_matchWithRegex",value:function(e){return this._regex.test(e)}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),tn=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,r._numberOfChoices=n,r}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=this._isNotPresent(e)||this._isNumber(e)&&this._withinRange(e);return new St(n,"Selected index outside of range")}return t}},{key:"updateNumberOfChoices",value:function(e){this._numberOfChoices=e}},{key:"_isNumber",value:function(e){return"number"==typeof e&&!isNaN(e)}},{key:"_withinRange",value:function(e){return e>=0&&e<this._numberOfChoices}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}}]),t}(Wt),nn=function(e){function t(e,n){var r;return u()(this,t),(r=l()(this,h()(t).call(this)))._mandatoryAnswerValidator=e,r._numberOfChoices=n,r}return v()(t,e),a()(t,[{key:"validate",value:function(e){var t=this._mandatoryAnswerValidator.validate(e);if(t.isValid()){var n=this._isNotPresent(e)||this._isAnArray(e)&&this._allValid(e);return new St(n,"Invalid selected indexes")}return t}},{key:"updateNumberOfChoices",value:function(e){this._numberOfChoices=e}},{key:"_isNotPresent",value:function(e){return!this._mandatoryAnswerValidator.isPresent(e)}},{key:"_isAnArray",value:function(e){return Array.isArray(e)}},{key:"_allValid",value:function(e){var t=this;return e.every((function(e){return t._isNumber(e)&&t._withinRange(e)}))}},{key:"_isNumber",value:function(e){return"number"==typeof e&&!isNaN(e)}},{key:"_withinRange",value:function(e){return e>=0&&e<this._numberOfChoices}}]),t}(Wt),rn=function(){function e(){u()(this,e)}return a()(e,[{key:"createAlwaysPassAnswerValidator",value:function(){return new Gt}},{key:"createBooleanAnswerValidator",value:function(e){return new Xt(new zt(e))}},{key:"createDateAnswerValidator",value:function(e,t,n,r){return new $t(this.createMandatoryAnswerValidator(e),t,n,r)}},{key:"createMandatoryAnswerValidator",value:function(e){return new zt(e)}},{key:"createMultiSelectChoicesAnswerValidator",value:function(e,t){return new Zt(this.createMandatoryAnswerValidator(e),t)}},{key:"createMultipleChoicesAnswerValidator",value:function(e,t){return new Jt(this.createMandatoryAnswerValidator(e),t)}},{key:"createNumberAnswerValidator",value:function(e,t,n){return new Qt(this.createMandatoryAnswerValidator(e),t,n)}},{key:"createRegexAnswerValidator",value:function(e,t,n){return new en(this.createMandatoryAnswerValidator(e),t,n)}},{key:"createMultipleChoicesRichContentAnswerValidator",value:function(e,t){return new tn(this.createMandatoryAnswerValidator(e),t)}},{key:"createMultiSelectChoicesRichContentAnswerValidator",value:function(e,t){return new nn(this.createMandatoryAnswerValidator(e),t)}}]),e}(),on=function(){function e(){u()(this,e)}return a()(e,[{key:"create",value:function(e,t){var n=t.security_token,r=t.expiry_time;return new Ue(e,n,r)}}]),e}(),un=function(){function e(){u()(this,e)}return a()(e,[{key:"storeItem",value:function(e,t){throw new Error("You must implement MWSdkStorage.storeItem(key, value) method")}},{key:"retrieveItem",value:function(e){throw new Error("You must implement MWSdkStorage.retrieveItem(key) method")}},{key:"deleteItem",value:function(e){throw new Error("You must implement MWSdkStorage.deleteItem(key) method")}},{key:"deleteAll",value:function(){throw new Error("You must implement MWSdkStorage.deleteAll() method")}}]),e}(),sn=function(e){function t(e){var n;return u()(this,t),(n=l()(this,h()(t).call(this)))._storage=e,n}return v()(t,e),a()(t,[{key:"storeItem",value:function(e,t){this._storage.setItem(e,t)}},{key:"retrieveItem",value:function(e){return this._storage.getItem(e)}},{key:"deleteItem",value:function(e){this._storage.removeItem(e)}},{key:"deleteAll",value:function(){this._storage.clear()}}]),t}(un),an=function(){function e(){u()(this,e)}return a()(e,null,[{key:"create",value:function(t){if("string"==typeof t)switch(t.toLowerCase()){case"local":return new sn(window.localStorage);case"session":return new sn(window.sessionStorage);default:e.throwUnknownStorageError()}else{if(t instanceof un)return t;e.throwUnknownStorageError()}}},{key:"throwUnknownStorageError",value:function(){throw new Error("Unknown storage type. Please specify storage type as 'session' or 'local' or as an instance of MWSdkStorage")}}]),e}(),cn=function(e){function t(e,n,r,i,o){var s,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;return u()(this,t),(s=l()(this,h()(t).call(this)))._id=e,s._type=n,s._name=r,s._ownerEntityId=i,s._ownerEntityType=o,s._relatedEntities=a,s}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"getName",value:function(){return this._name}},{key:"getOwnerEntityId",value:function(){return this._ownerEntityId}},{key:"getOwnerEntityType",value:function(){return this._ownerEntityType}},{key:"getRelatedEntities",value:function(){var e=this;return this._relatedEntities?Promise.resolve(this._relatedEntities):this._getCloudEntityService().fetchCloudRelatedEntities(this._id,this._type).then((function(t){return e._relatedEntities=t,Promise.resolve(t)}))}},{key:"getRelatedEntityByName",value:function(e){return this.getRelatedEntities().then((function(t){var n=t[e];return Promise.resolve(n)}))}},{key:"deleteRelatedEntityByName",value:function(e){var t=this;if(this._relatedEntities&&this._relatedEntities[e]){var n=this._relatedEntities[e],r=n.getId(),i=n.getType();return delete this._relatedEntities[e],this._getCloudEntityService().deleteCloudRelatedEntity(this._ownerEntityId,this._ownerEntityType,r,i,this._name).then((function(){return Promise.resolve(new p(!0,t))}))}return Promise.resolve(new p(!1,this,"Related entity ".concat(e," is not found for relationship ").concat(this._name,".")))}},{key:"reload",value:function(e){return this._relatedEntities?(this._removeDeletedRelatedEntities(e),this._addNewRelatedEntities(e)):this._relatedEntities=e,this}},{key:"toObjectLiteral",value:function(){var e=this,t=Object.keys(this._relatedEntities||{}).reduce((function(t,n){return t[n]=e._relatedEntities[n].toObjectLiteral(),t}),{});return{id:this._id,type:this._type,name:this._name,relatedEntities:t}}},{key:"_removeDeletedRelatedEntities",value:function(e){var t=this,n=Object.keys(this._relatedEntities),r=Object.keys(e);n.filter((function(e){return!r.includes(e)})).forEach((function(e){t._getCloudEntityService().removeCloudEntityFromCache(t._relatedEntities[e].getId()),delete t._relatedEntities[e]}))}},{key:"_addNewRelatedEntities",value:function(e){var t=this,n=Object.keys(this._relatedEntities);Object.keys(e).filter((function(e){return!n.includes(e)})).forEach((function(n){t._relatedEntities[n]=e[n]}))}},{key:"_getCloudEntityService",value:function(){return vn.getCloudEntityService()}}]),t}(_),ln=function(){function e(){u()(this,e)}return a()(e,[{key:"create",value:function(e){var t=e.id,n=e.payload,r=n.type,i=n.name,o=n.attributes,u=this._createCloudEntityRelationship(t,r,n.links);return new _n(t,r,i,o,u)}},{key:"_createCloudEntityRelationship",value:function(e,t,n){return n.reduce((function(n,r){var i,o=r.href,u=L(o),s=(i=o).substring(i.indexOf("type=")+"type=".length,i.indexOf("id=")-1),a=r.rel;return n[a]=new cn(u,s,a,e,t),n}),{})}}]),e}(),fn=function(e){function t(e,n,r){var i;return u()(this,t),(i=l()(this,h()(t).call(this)))._id=e,i._type=n,i._name=r,i}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"getName",value:function(){return this._name}},{key:"getCloudEntity",value:function(){return this._getCloudEntityService().findOrFetchCloudEntity(this._id)}},{key:"toObjectLiteral",value:function(){return{id:this._id,type:this._type,name:this._name}}},{key:"_getCloudEntityService",value:function(){return vn.getCloudEntityService()}}]),t}(y),hn=function(){function e(){u()(this,e)}return a()(e,[{key:"create",value:function(e){return e.payload.related_entities.reduce((function(e,t){var n=t.id,r=t.type,i=t.name;return e[i]=new fn(n,r,i),e}),{})}}]),e}(),dn=function(e){function t(){var e;return u()(this,t),(e=l()(this,h()(t).call(this)))._cloudEntities=new Map,e}return v()(t,e),a()(t,[{key:"cacheCloudEntity",value:function(e){var t=e.getId(),n=this._cloudEntities.get(t);return n?n.reload(e):(this._cloudEntities.set(t,e),n=e),n}},{key:"removeCloudEntity",value:function(e){this._cloudEntities.delete(e)}},{key:"lookupCloudEntity",value:function(e){return this._cloudEntities.get(e)}},{key:"clear",value:function(){this._cloudEntities.clear()}},{key:"getCloudEntities",value:function(){return this._cloudEntities}},{key:"toObjectLiteral",value:function(){var e=this;return oe()(this._cloudEntities.keys()).reduce((function(t,n){return t[n]=e._cloudEntities.get(n).toObjectLiteral(),t}),{})}}]),t}(y),vn=function(){function e(){u()(this,e)}return a()(e,null,[{key:"setup",value:function(t){var n,r=t.getPlatformServiceUrl(),o=t.getClientServiceLoginUrl(),u=t.getClientServiceSignUpUrl(),s=t.getDetectEntityUpdatesInterval(),a=t.getRequestTimeOut(),c=t.getServiceUnavailableTimeOut(),l=t.getSecurityTokenRefreshedOffset(),f=t.getBackoffIntervalOnWaitingLiveAgentResponse(),h=t.getConversationsUpdatedCallback(),d=t.getConversationUpdatedCallback(),v=t.getCloudEntityUpdatedCallback(),y=t.getCloudEntityRelationshipUpdatedCallback(),_=t.getStorageType(),p=new Ne(a),g=new He(a,c),O=new A(g,o,u),b=new J(g,r,a,p),E=new ve(g,a,p),C=new on,T=new Ye(C),w=new ln,I=new hn,R=new Kt(new it,new rn),U=new et(R),D=new Ge(U),P=new $e,F=an.create(_),M=new Me,L=new Fe(b,C,F,M,l),N=new Pe(F,L),x=new Ae(b,N),V=new je(r,E,N),q=new ye(r,x),H=new Oe(g,q,a,p),Y=new Te(H);e.fieldFactoryRegistry=R;var B=new Ze,K=new dn,W=new j(V,x,w,I,K),G=new ne(x,V,N,Y,D,B,f),X=new de(V,P,B),$=new he(r,E,N),z=new re(B,X,h),Z=new ae(B,G,d),Q=new ue(K,W,v),ee=new se(K,W,y),te=new ce(z,Z,Q,ee),ie=new fe(W,X,N,$,te,B,K,s),oe=new k(b,T,N,ie),le=new Ee(b,O,T,N,ie),_e=new Ce(x,N,ie),pe=new Ie(r,E),ge=new Le(b,O,oe,N,C),me=new S(ge,le);e.services=(n={},i()(n,m.ACCOUNT_SERVICE,oe),i()(n,m.AUTHENTICATION_SERVICE,me),i()(n,m.CLOUD_ENTITY_SERVICE,W),i()(n,m.CONVERSATION_SERVICE,G),i()(n,m.CONVERSATIONS_SERVICE,X),i()(n,m.ENTITY_UPDATES_OBSERVER_SERVICE,ie),i()(n,m.FETCH_RICH_CONTENT_SERVICE,H),i()(n,m.LOGIN_SERVICE,le),i()(n,m.LOGOUT_SERVICE,_e),i()(n,m.SERVER_CONFIG_SERVICE,pe),i()(n,m.SECURITY_TOKEN_SERVICE,N),i()(n,m.SIGN_UP_SERVICE,ge),n)}},{key:"getAccountService",value:function(){return e.services[m.ACCOUNT_SERVICE]}},{key:"getAuthenticationService",value:function(){return e.services[m.AUTHENTICATION_SERVICE]}},{key:"getCloudEntityService",value:function(){return e.services[m.CLOUD_ENTITY_SERVICE]}},{key:"getConversationService",value:function(){return e.services[m.CONVERSATION_SERVICE]}},{key:"getConversationsService",value:function(){return e.services[m.CONVERSATIONS_SERVICE]}},{key:"getEntityUpdatesObserverService",value:function(){return e.services[m.ENTITY_UPDATES_OBSERVER_SERVICE]}},{key:"getFetchRichContentService",value:function(){return e.services[m.FETCH_RICH_CONTENT_SERVICE]}},{key:"getLoginService",value:function(){return e.services[m.LOGIN_SERVICE]}},{key:"getLogoutService",value:function(){return e.services[m.LOGOUT_SERVICE]}},{key:"getServerConfigService",value:function(){return e.services[m.SERVER_CONFIG_SERVICE]}},{key:"getSecurityTokenService",value:function(){return e.services[m.SECURITY_TOKEN_SERVICE]}},{key:"getSignUpService",value:function(){return e.services[m.SIGN_UP_SERVICE]}},{key:"registerInteractionFieldFactory",value:function(t,n){e.fieldFactoryRegistry.register(t,n)}}]),e}();function yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var _n=function(e){function t(e,n,r,i,o){var s;return u()(this,t),(s=l()(this,h()(t).call(this)))._id=e,s._type=n,s._name=r,s._attributes=i,s._relationships=o,s}return v()(t,e),a()(t,[{key:"getId",value:function(){return this._id}},{key:"getType",value:function(){return this._type}},{key:"getName",value:function(){return this._name}},{key:"getAttributes",value:function(){return this._attributes}},{key:"getRelationships",value:function(){return this._relationships}},{key:"getRelationshipByName",value:function(e){return this._relationships[e]}},{key:"getRelatedEntitiesByRelationshipName",value:function(e){var t=this.getRelationshipByName(e);return t?t.getRelatedEntities():Promise.resolve(void 0)}},{key:"getRelatedEntityByRelationshipNameAndRelatedEntityName",value:function(e,t){var n=this.getRelationshipByName(e);return n?n.getRelatedEntityByName(t).then((function(e){return e?e.getCloudEntity():Promise.resolve(void 0)})):Promise.resolve(void 0)}},{key:"deleteRelatedEntityByRelationshipNameAndRelatedEntityName",value:function(e,t){var n=this.getRelationshipByName(e);return n?n.deleteRelatedEntityByName(t):Promise.resolve(new p(!1,void 0,"Relationship ".concat(e," is unknown.")))}},{key:"deleteAttribute",value:function(e){var t=this;return this._attributes[e]?(delete this._attributes[e],this._getCloudEntityService().deleteCloudEntityAttribute(this._id,this._type,e).then((function(){return Promise.resolve(new g(!0,t))}))):Promise.resolve(new g(!1,this,"Attribute ".concat(e," is unknown.")))}},{key:"reload",value:function(e){var t=this;this._name=e.getName(),this._attributes=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.getAttributes());var n=e.getRelationships();return Object.keys(n).forEach((function(e){t.getRelationshipByName(e)||(t._relationships[e]=n[e])})),this}},{key:"toObjectLiteral",value:function(){var e=this,t=Object.keys(this._relationships).reduce((function(t,n){return t[n]=e._relationships[n].toObjectLiteral(),t}),{});return{id:this._id,type:this._type,name:this._name,attributes:this._attributes,relationships:t}}},{key:"_getCloudEntityService",value:function(){return vn.getCloudEntityService()}}]),t}(_),pn=function(){function e(t){u()(this,e),vn.setup(t),this._executeInitialisationTasks()}return a()(e,[{key:"getServerConfig",value:function(){return this._getServerConfigService().retrieveConfig()}},{key:"createAccount",value:function(){return this._getAccountService().createAccount()}},{key:"getCurrentStoredAccount",value:function(){return this._getAccountService().getCurrentStoredAccount()}},{key:"clearCurrentStoredAccount",value:function(){return this._getAccountService().clearCurrentStoredAccount()}},{key:"authenticate",value:function(e){return this._getAuthenticationService().authenticate(e)}},{key:"login",value:function(e){return this._getLoginService().login(e)}},{key:"signUp",value:function(e){return this._getSignUpService().signUp(e)}},{key:"logout",value:function(){return this._getLogoutService().logout()}},{key:"getCloudEntity",value:function(e){return this._getCloudEntityService().findCloudEntity(e)}},{key:"getConversation",value:function(e){return this._getConversationService().findConversation(e)}},{key:"registerInteractionFieldFactory",value:function(e,t){vn.registerInteractionFieldFactory(e,t)}},{key:"_getAccountService",value:function(){return vn.getAccountService()}},{key:"_getAuthenticationService",value:function(){return vn.getAuthenticationService()}},{key:"_getLoginService",value:function(){return vn.getLoginService()}},{key:"_getLogoutService",value:function(){return vn.getLogoutService()}},{key:"_getServerConfigService",value:function(){return vn.getServerConfigService()}},{key:"_getSignUpService",value:function(){return vn.getSignUpService()}},{key:"_getCloudEntityService",value:function(){return vn.getCloudEntityService()}},{key:"_getConversationService",value:function(){return vn.getConversationService()}},{key:"_executeInitialisationTasks",value:function(){var e=vn.getSecurityTokenService();if(e.isCurrentAccountSecurityTokenValid()){e.startAccountSecurityTokenRefreshmentTask();var t=vn.getEntityUpdatesObserverService(),n=e.getCurrentStoredAccount();t.startObservingEntityUpdates(n)}}}]),e}(),gn=function(){function e(t,n,r){u()(this,e),this._platformServiceUrl=t,this._clientServiceLoginUrl=n,this._clientServiceSignUpUrl=r,this._detectEntityUpdatesIntervalInMilliseconds=3e4,this._requestTimeOutInMilliseconds=3e5,this._serviceUnavailableTimeOutInMilliseconds=3e4,this._securityTokenRefreshedOffsetInMilliseconds=12e4,this._backoffIntervalOnWaitingLiveAgentResponseInMilliseconds=2e3,this._onConversationsUpdated=function(){},this._onConversationUpdated=function(){},this._onCloudEntityUpdated=function(){},this._onCloudEntityRelationshipUpdated=function(){},this._storageType="local"}return a()(e,[{key:"withDetectEntityUpdatesInterval",value:function(e){return this._detectEntityUpdatesIntervalInMilliseconds=e,this}},{key:"withRequestTimeOut",value:function(e){return this._requestTimeOutInMilliseconds=e,this}},{key:"withServiceUnavailableTimeOut",value:function(e){return this._serviceUnavailableTimeOutInMilliseconds=e,this}},{key:"withSecurityTokenRefreshedOffset",value:function(e){return this._securityTokenRefreshedOffsetInMilliseconds=e,this}},{key:"withBackoffIntervalOnWaitingLiveAgentResponse",value:function(e){return this._backoffIntervalOnWaitingLiveAgentResponseInMilliseconds=e,this}},{key:"withConversationsUpdatedCallback",value:function(e){return this._onConversationsUpdated=e,this}},{key:"withConversationUpdatedCallback",value:function(e){return this._onConversationUpdated=e,this}},{key:"withCloudEntityUpdatedCallback",value:function(e){return this._onCloudEntityUpdated=e,this}},{key:"withCloudEntityRelationshipUpdatedCallback",value:function(e){return this._onCloudEntityRelationshipUpdated=e,this}},{key:"withStorageType",value:function(e){return this._storageType=e,this}},{key:"getPlatformServiceUrl",value:function(){return this._platformServiceUrl}},{key:"getClientServiceLoginUrl",value:function(){return this._clientServiceLoginUrl}},{key:"getClientServiceSignUpUrl",value:function(){return this._clientServiceSignUpUrl}},{key:"getDetectEntityUpdatesInterval",value:function(){return this._detectEntityUpdatesIntervalInMilliseconds}},{key:"getRequestTimeOut",value:function(){return this._requestTimeOutInMilliseconds}},{key:"getServiceUnavailableTimeOut",value:function(){return this._serviceUnavailableTimeOutInMilliseconds}},{key:"getSecurityTokenRefreshedOffset",value:function(){return this._securityTokenRefreshedOffsetInMilliseconds}},{key:"getBackoffIntervalOnWaitingLiveAgentResponse",value:function(){return this._backoffIntervalOnWaitingLiveAgentResponseInMilliseconds}},{key:"getConversationsUpdatedCallback",value:function(){return this._onConversationsUpdated}},{key:"getConversationUpdatedCallback",value:function(){return this._onConversationUpdated}},{key:"getCloudEntityUpdatedCallback",value:function(){return this._onCloudEntityUpdated}},{key:"getCloudEntityRelationshipUpdatedCallback",value:function(){return this._onCloudEntityRelationshipUpdated}},{key:"getStorageType",value:function(){return this._storageType}}]),e}();n.d(t,"Account",(function(){return Re})),n.d(t,"Conversation",(function(){return We})),n.d(t,"ConversationSummary",(function(){return Ke})),n.d(t,"Conversations",(function(){return Xe})),n.d(t,"Interaction",(function(){return Qe})),n.d(t,"SecurityToken",(function(){return Ue})),n.d(t,"ServerConfig",(function(){return we})),n.d(t,"SubmitAnswerResult",(function(){return Be})),n.d(t,"User",(function(){return be})),n.d(t,"CloudEntity",(function(){return _n})),n.d(t,"CloudEntityRelationship",(function(){return cn})),n.d(t,"CloudRelatedEntity",(function(){return fn})),n.d(t,"DeleteCloudEntityAttributeResult",(function(){return g})),n.d(t,"DeleteRelatedEntityResult",(function(){return p})),n.d(t,"FieldFactory",(function(){return ot})),n.d(t,"ConfirmDetailsField",(function(){return st})),n.d(t,"ConfirmationField",(function(){return lt})),n.d(t,"CurrencyField",(function(){return dt})),n.d(t,"Date",(function(){return tt})),n.d(t,"DateField",(function(){return _t})),n.d(t,"DateTime",(function(){return rt})),n.d(t,"EmailField",(function(){return mt})),n.d(t,"Field",(function(){return ge})),n.d(t,"MultiSelectChoicesField",(function(){return bt})),n.d(t,"MultipleChoicesField",(function(){return At})),n.d(t,"MultipleChoicesWithOtherField",(function(){return Dt})),n.d(t,"MultipleChoicesWithRichContentField",(function(){return Se})),n.d(t,"NumberField",(function(){return Lt})),n.d(t,"StartNewConversationWithIntentField",(function(){return Vt})),n.d(t,"TextField",(function(){return Yt})),n.d(t,"AlwaysPassAnswerValidator",(function(){return Gt})),n.d(t,"AnswerValidator",(function(){return Wt})),n.d(t,"BooleanAnswerValidator",(function(){return Xt})),n.d(t,"DateAnswerValidator",(function(){return $t})),n.d(t,"MandatoryAnswerValidator",(function(){return zt})),n.d(t,"MultiSelectChoicesAnswerValidator",(function(){return Zt})),n.d(t,"MultipleChoicesAnswerValidator",(function(){return Jt})),n.d(t,"NumberAnswerValidator",(function(){return Qt})),n.d(t,"RegexAnswerValidator",(function(){return en})),n.d(t,"RichContentAnswerValidator",(function(){return tn})),n.d(t,"ValidationResult",(function(){return St})),n.d(t,"MWSdkStorage",(function(){return un})),n.d(t,"MWSdkError",(function(){return I})),n.d(t,"MWSdk",(function(){return pn})),n.d(t,"MWSdkConfig",(function(){return gn})),n.d(t,"MWSdkLogger",(function(){return le}))}])}));
//# sourceMappingURL=mywaveAiJsSdk.js.map